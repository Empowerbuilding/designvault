{"version":3,"sources":["../src/api/client.ts","../src/hooks/useDesignVault.ts","../src/hooks/usePlans.ts","../src/components/CategoryTiles.tsx","../src/components/FilterBar.tsx","../src/components/FavoriteButton.tsx","../src/components/PlanCard.tsx","../src/components/FeaturedRow.tsx","../src/hooks/useFavorites.ts","../src/components/ArchiveGrid.tsx","../src/types/index.ts","../src/components/StyleSwapButtons.tsx","../src/components/ImageLightbox.tsx","../src/components/FloorPlanEditor.tsx","../src/utils/tracking.ts","../src/hooks/useLeadCapture.ts","../src/components/LeadCaptureModal.tsx","../src/hooks/useAIInteractions.ts","../src/components/AIToolsPanel.tsx","../src/components/SimilarPlans.tsx","../src/hooks/useSession.ts","../src/components/PlanDetail.tsx","../src/components/DesignVault.tsx"],"names":["useState","useMemo","useCallback","jsxs","jsx","Home","useRef","useEffect","motion","X","Loader2","Sparkles","ANON_ID_KEY","getCookie","AnimatePresence","Bath","Square","getSessionDuration","ArrowRight","Check","Fragment"],"mappings":"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","file":"index.mjs","sourcesContent":["import type {\n  AIInteractionResult,\n  FloorPlan,\n  LeadCaptureData,\n  PlanFilters,\n} from \"../types\";\n\nexport class CaptureRequiredError extends Error {\n  constructor() {\n    super(\"Lead capture required\");\n    this.name = \"CaptureRequiredError\";\n  }\n}\n\nexport class DesignVaultAPI {\n  private baseUrl: string;\n\n  constructor(apiBaseUrl: string) {\n    this.baseUrl = apiBaseUrl.replace(/\\/$/, \"\");\n  }\n\n  //  Plans \n\n  async getPlans(filters?: PlanFilters): Promise<FloorPlan[]> {\n    const params = new URLSearchParams();\n\n    if (filters) {\n      if (filters.bedrooms !== null && filters.bedrooms !== undefined) {\n        params.set(\"bedrooms\", String(filters.bedrooms));\n      }\n      if (filters.bathrooms !== null && filters.bathrooms !== undefined) {\n        params.set(\"bathrooms\", String(filters.bathrooms));\n      }\n      if (filters.minArea !== null && filters.minArea !== undefined) {\n        params.set(\"minArea\", String(filters.minArea));\n      }\n      if (filters.maxArea !== null && filters.maxArea !== undefined) {\n        params.set(\"maxArea\", String(filters.maxArea));\n      }\n      if (filters.style !== null && filters.style !== undefined) {\n        params.set(\"style\", filters.style);\n      }\n      if (filters.category !== null && filters.category !== undefined) {\n        params.set(\"category\", filters.category);\n      }\n    }\n\n    const query = params.toString();\n    const url = `${this.baseUrl}/api/plans${query ? `?${query}` : \"\"}`;\n\n    return this.get<FloorPlan[]>(url);\n  }\n\n  async getPlan(id: string): Promise<FloorPlan> {\n    return this.get<FloorPlan>(`${this.baseUrl}/api/plans/${id}`);\n  }\n\n  //  Tracking \n\n  async trackClick(planId: string): Promise<void> {\n    await this.post<void>(`${this.baseUrl}/api/plans/${planId}/click`, {});\n  }\n\n  //  AI \n\n  async styleSwap(\n    planId: string,\n    preset: string,\n    sessionId: string,\n    imageType?: \"exterior\" | \"interior\",\n    imageUrl?: string\n  ): Promise<AIInteractionResult> {\n    return this.post<AIInteractionResult>(\n      `${this.baseUrl}/api/style-swap`,\n      { planId, preset, sessionId, imageType, imageUrl }\n    );\n  }\n\n  async floorPlanEdit(\n    planId: string,\n    prompt: string,\n    sessionId: string,\n    currentUrl?: string\n  ): Promise<AIInteractionResult> {\n    return this.post<AIInteractionResult>(\n      `${this.baseUrl}/api/floor-plan-edit`,\n      { planId, prompt, sessionId, currentUrl }\n    );\n  }\n\n  async enhancePrompt(\n    prompt: string,\n    imageUrl: string\n  ): Promise<{ enhancedPrompt: string }> {\n    return this.post<{ enhancedPrompt: string }>(\n      `${this.baseUrl}/api/enhance-prompt`,\n      { prompt, imageUrl }\n    );\n  }\n\n  //  Lead Capture \n\n  async saveDesign(\n    data: LeadCaptureData,\n    sessionId: string,\n    builderSlug: string\n  ): Promise<{ success: boolean }> {\n    return this.post<{ success: boolean }>(\n      `${this.baseUrl}/api/save-design`,\n      { leadData: data, sessionId, builderSlug }\n    );\n  }\n\n  //  Sessions \n\n  async createSession(\n    planId: string,\n    builderSlug: string,\n    anonymousId: string\n  ): Promise<{ sessionId: string }> {\n    return this.post<{ sessionId: string }>(\n      `${this.baseUrl}/api/sessions`,\n      { planId, builderSlug, anonymousId }\n    );\n  }\n\n  //  Internal helpers \n\n  private friendlyError(status: number): string {\n    if (status === 429) return \"Too many requests  please wait a moment and try again.\";\n    if (status === 403) return \"Save your design to unlock more AI tools.\";\n    if (status === 404) return \"This design could not be found. Please try another.\";\n    if (status >= 500) return \"Our servers are busy  please try again in a few seconds.\";\n    return \"Something went wrong. Please try again.\";\n  }\n\n  private async get<T>(url: string): Promise<T> {\n    try {\n      const res = await fetch(url);\n      if (!res.ok) throw new Error(this.friendlyError(res.status));\n      return (await res.json()) as T;\n    } catch (err) {\n      if (err instanceof Error) throw err;\n      throw new Error(\"Unable to connect. Please check your internet and try again.\");\n    }\n  }\n\n  private async post<T>(url: string, body: unknown): Promise<T> {\n    try {\n      const res = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n      if (!res.ok) {\n        // Parse 403 to detect \"needs capture\" vs generic forbidden\n        if (res.status === 403) {\n          try {\n            const data = await res.json();\n            if (data?.needsCapture) throw new CaptureRequiredError();\n          } catch (e) {\n            if (e instanceof CaptureRequiredError) throw e;\n          }\n        }\n        throw new Error(this.friendlyError(res.status));\n      }\n      // Some endpoints (trackClick) may return 204 with no body\n      const text = await res.text();\n      if (!text) return undefined as T;\n      return JSON.parse(text) as T;\n    } catch (err) {\n      if (err instanceof Error) throw err;\n      throw new Error(\"Unable to connect. Please check your internet and try again.\");\n    }\n  }\n}\n","import React, {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { DesignVaultAPI } from \"../api/client\";\nimport type { DesignVaultConfig, FloorPlan, Modification } from \"../types\";\n\n//  Anonymous ID \n\nconst ANON_ID_KEY = \"dv-anonymous-id\";\n\nfunction generateId(): string {\n  if (typeof crypto !== \"undefined\" && typeof crypto.randomUUID === \"function\") {\n    return crypto.randomUUID();\n  }\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0;\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n  });\n}\n\nconst CRM_VISITOR_KEY = \"_crm_visitor_id\";\nconst CAPTURED_KEY = \"dv-captured\";\n\nfunction getOrCreateAnonymousId(): string {\n  if (typeof window === \"undefined\") return generateId();\n  try {\n    // Prefer the CRM tracking script's visitor ID so page views link to the contact\n    const crmId = localStorage.getItem(CRM_VISITOR_KEY);\n    if (crmId) {\n      localStorage.setItem(ANON_ID_KEY, crmId);\n      return crmId;\n    }\n    const existing = localStorage.getItem(ANON_ID_KEY);\n    if (existing) return existing;\n    const id = generateId();\n    localStorage.setItem(ANON_ID_KEY, id);\n    return id;\n  } catch {\n    return generateId();\n  }\n}\n\n//  Context \n\nexport interface DesignVaultContextValue {\n  config: DesignVaultConfig;\n  api: DesignVaultAPI;\n  anonymousId: string;\n  sessionStartTime: number;\n\n  // Lead capture gate\n  isCaptured: boolean;\n  setCaptured: (captured: boolean) => void;\n\n  // Session tracking (shared across hooks)\n  sessionId: string | null;\n  setSessionId: (id: string | null) => void;\n  modifications: Modification[];\n  addModification: (mod: Modification) => void;\n  plansViewed: string[];\n  addPlanViewed: (planId: string) => void;\n  currentPlan: FloorPlan | null;\n  setCurrentPlan: (plan: FloorPlan | null) => void;\n  stylePref: string | null;\n  setStylePref: (pref: string | null) => void;\n}\n\nexport const DesignVaultContext =\n  createContext<DesignVaultContextValue | null>(null);\n\nexport function useDesignVaultContext(): DesignVaultContextValue {\n  const ctx = useContext(DesignVaultContext);\n  if (!ctx) {\n    throw new Error(\n      \"useDesignVaultContext must be used within a DesignVaultProvider\"\n    );\n  }\n  return ctx;\n}\n\n//  Provider \n\nexport interface DesignVaultProviderProps {\n  config: DesignVaultConfig;\n  children: React.ReactNode;\n}\n\nexport function DesignVaultProvider({\n  config,\n  children,\n}: DesignVaultProviderProps) {\n  const api = useMemo(\n    () => new DesignVaultAPI(config.apiBaseUrl),\n    [config.apiBaseUrl]\n  );\n\n  const [anonymousId] = useState(getOrCreateAnonymousId);\n  const sessionStartRef = useRef(Date.now());\n\n  const [isCaptured, setIsCaptured] = useState(() => {\n    if (typeof window === \"undefined\") return false;\n    try { return localStorage.getItem(CAPTURED_KEY) === \"1\"; } catch { return false; }\n  });\n  const setCaptured = useCallback((captured: boolean) => {\n    setIsCaptured(captured);\n    try { if (captured) localStorage.setItem(CAPTURED_KEY, \"1\"); } catch { /* noop */ }\n  }, []);\n  const [sessionId, setSessionId] = useState<string | null>(null);\n  const [modifications, setModifications] = useState<Modification[]>([]);\n  const [plansViewed, setPlansViewed] = useState<string[]>([]);\n  const [currentPlan, setCurrentPlan] = useState<FloorPlan | null>(null);\n  const [stylePref, setStylePref] = useState<string | null>(null);\n\n  const addModification = useCallback((mod: Modification) => {\n    setModifications((prev) => [...prev, mod]);\n  }, []);\n\n  const addPlanViewed = useCallback((planId: string) => {\n    setPlansViewed((prev) =>\n      prev.includes(planId) ? prev : [...prev, planId]\n    );\n  }, []);\n\n  const value = useMemo<DesignVaultContextValue>(\n    () => ({\n      config,\n      api,\n      anonymousId,\n      sessionStartTime: sessionStartRef.current,\n      isCaptured,\n      setCaptured,\n      sessionId,\n      setSessionId,\n      modifications,\n      addModification,\n      plansViewed,\n      addPlanViewed,\n      currentPlan,\n      setCurrentPlan,\n      stylePref,\n      setStylePref,\n    }),\n    [\n      config,\n      api,\n      anonymousId,\n      isCaptured,\n      sessionId,\n      modifications,\n      plansViewed,\n      currentPlan,\n      stylePref,\n      addModification,\n      addPlanViewed,\n    ]\n  );\n\n  return React.createElement(\n    DesignVaultContext.Provider,\n    { value },\n    children\n  );\n}\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useDesignVaultContext } from \"./useDesignVault\";\nimport type { FloorPlan, FloorPlanCategory, FloorPlanStyle, PlanFilters } from \"../types\";\n\nconst EMPTY_FILTERS: PlanFilters = {\n  bedrooms: null,\n  bathrooms: null,\n  minArea: null,\n  maxArea: null,\n  style: null,\n  category: null,\n};\n\nexport function usePlans(initialFilters?: PlanFilters) {\n  const { api } = useDesignVaultContext();\n\n  const [plans, setPlans] = useState<FloorPlan[]>([]);\n  const [filters, setFilters] = useState<PlanFilters>(\n    initialFilters ?? EMPTY_FILTERS\n  );\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Fetch all plans once on mount\n  useEffect(() => {\n    let cancelled = false;\n    setLoading(true);\n\n    api\n      .getPlans()\n      .then((data) => {\n        if (!cancelled) {\n          setPlans(data);\n          setError(null);\n        }\n      })\n      .catch((err) => {\n        if (!cancelled) {\n          setError(err instanceof Error ? err.message : String(err));\n        }\n      })\n      .finally(() => {\n        if (!cancelled) setLoading(false);\n      });\n\n    return () => {\n      cancelled = true;\n    };\n  }, [api]);\n\n  // Client-side filtering for instant response\n  const filteredPlans = useMemo(() => {\n    return plans.filter((plan) => {\n      if (filters.bedrooms !== null && plan.beds !== filters.bedrooms)\n        return false;\n      if (filters.bathrooms !== null && plan.baths !== filters.bathrooms)\n        return false;\n      if (filters.minArea !== null && plan.area < filters.minArea)\n        return false;\n      if (filters.maxArea !== null && plan.area > filters.maxArea)\n        return false;\n      if (filters.style !== null && plan.style !== filters.style) return false;\n      if (filters.category !== null && plan.category !== filters.category)\n        return false;\n      return true;\n    });\n  }, [plans, filters]);\n\n  // Featured: featured === true, sorted by click_count desc, limit 6\n  const featuredPlans = useMemo(() => {\n    return plans\n      .filter((p) => p.featured)\n      .sort((a, b) => b.click_count - a.click_count)\n      .slice(0, 6);\n  }, [plans]);\n\n  // Recent: sorted by created_at desc, limit 4\n  const recentPlans = useMemo(() => {\n    return [...plans]\n      .sort(\n        (a, b) =>\n          new Date(b.created_at).getTime() - new Date(a.created_at).getTime()\n      )\n      .slice(0, 4);\n  }, [plans]);\n\n  //  Derived filter options \n\n  const uniqueBedrooms = useMemo(\n    () => [...new Set(plans.map((p) => p.beds))].sort((a, b) => a - b),\n    [plans]\n  );\n\n  const uniqueBathrooms = useMemo(\n    () => [...new Set(plans.map((p) => p.baths))].sort((a, b) => a - b),\n    [plans]\n  );\n\n  const areaRange = useMemo(() => {\n    if (plans.length === 0) return { min: 0, max: 0 };\n    const areas = plans.map((p) => p.area);\n    return { min: Math.min(...areas), max: Math.max(...areas) };\n  }, [plans]);\n\n  const uniqueStyles = useMemo(\n    () =>\n      [\n        ...new Set(plans.map((p) => p.style).filter(Boolean)),\n      ] as FloorPlanStyle[],\n    [plans]\n  );\n\n  const uniqueCategories = useMemo(\n    () =>\n      [\n        ...new Set(plans.map((p) => p.category).filter(Boolean)),\n      ] as FloorPlanCategory[],\n    [plans]\n  );\n\n  const clearFilters = useCallback(() => setFilters(EMPTY_FILTERS), []);\n\n  return {\n    plans,\n    filteredPlans,\n    featuredPlans,\n    recentPlans,\n    loading,\n    error,\n    filters,\n    setFilters,\n    clearFilters,\n    uniqueBedrooms,\n    uniqueBathrooms,\n    areaRange,\n    uniqueStyles,\n    uniqueCategories,\n  };\n}\n","import React from \"react\";\nimport { Home, Mountain, Crown, TreePine, Minimize2, Warehouse } from \"lucide-react\";\nimport type { CategoryTilesProps, FloorPlanCategory } from \"../types\";\n\ninterface CategoryConfig {\n  slug: FloorPlanCategory;\n  label: string;\n  icon: React.ReactNode;\n}\n\nconst CATEGORIES: CategoryConfig[] = [\n  { slug: \"barndominium\", label: \"Modern Barndo\", icon: <Home size={22} /> },\n  { slug: \"ranch\", label: \"Rustic Ranch\", icon: <Mountain size={22} /> },\n  { slug: \"estate\", label: \"Luxury Estate\", icon: <Crown size={22} /> },\n  { slug: \"cabin\", label: \"Hill Country\", icon: <TreePine size={22} /> },\n  { slug: \"starter\", label: \"Compact / Starter\", icon: <Minimize2 size={22} /> },\n  { slug: \"shop_house\", label: \"Shop + Living\", icon: <Warehouse size={22} /> },\n];\n\nexport const CategoryTiles: React.FC<CategoryTilesProps> = ({\n  activeCategory,\n  onSelect,\n}) => {\n  return (\n    <div className=\"dv-category-tiles\">\n      {CATEGORIES.map((cat) => (\n        <button\n          key={cat.slug}\n          className={`dv-category-tile ${\n            activeCategory === cat.slug ? \"dv-category-tile--active\" : \"\"\n          }`}\n          onClick={() =>\n            onSelect(activeCategory === cat.slug ? null : cat.slug)\n          }\n        >\n          <span className=\"dv-category-tile__icon\">{cat.icon}</span>\n          <span className=\"dv-category-tile__label\">{cat.label}</span>\n        </button>\n      ))}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Filter, X } from \"lucide-react\";\nimport type { FilterBarProps, FloorPlanStyle } from \"../types\";\n\nconst AREA_RANGES = [\n  { label: \"Under 1,000 sqft\", min: 0, max: 999 },\n  { label: \"1,000  1,500 sqft\", min: 1000, max: 1500 },\n  { label: \"1,500  2,000 sqft\", min: 1500, max: 2000 },\n  { label: \"2,000  2,500 sqft\", min: 2000, max: 2500 },\n  { label: \"2,500  3,000 sqft\", min: 2500, max: 3000 },\n  { label: \"3,000+ sqft\", min: 3000, max: 99999 },\n];\n\nconst STYLE_LABELS: Record<FloorPlanStyle, string> = {\n  modern: \"Modern\",\n  traditional: \"Traditional\",\n  rustic: \"Rustic\",\n  contemporary: \"Contemporary\",\n  farmhouse: \"Farmhouse\",\n  hill_country: \"Hill Country\",\n};\n\nfunction hasActiveFilters(filters: FilterBarProps[\"filters\"]): boolean {\n  return (\n    filters.bedrooms !== null ||\n    filters.bathrooms !== null ||\n    filters.minArea !== null ||\n    filters.maxArea !== null ||\n    filters.style !== null\n  );\n}\n\nexport const FilterBar: React.FC<FilterBarProps> = ({\n  filters,\n  setFilters,\n  clearFilters,\n  uniqueBedrooms,\n  uniqueBathrooms,\n  uniqueStyles,\n  totalCount,\n  filteredCount,\n}) => {\n  const active = hasActiveFilters(filters);\n\n  return (\n    <div className=\"dv-filter-bar\">\n      <div className=\"dv-filter-bar__icon\">\n        <Filter size={18} />\n      </div>\n\n      <div className=\"dv-filter-bar__selects\">\n        {/* Bedrooms */}\n        <select\n          className=\"dv-filter-bar__select\"\n          value={filters.bedrooms ?? \"\"}\n          onChange={(e) =>\n            setFilters({\n              ...filters,\n              bedrooms: e.target.value ? Number(e.target.value) : null,\n            })\n          }\n        >\n          <option value=\"\">Bedrooms</option>\n          {uniqueBedrooms.map((b) => (\n            <option key={b} value={b}>\n              {b} Bed{b !== 1 ? \"s\" : \"\"}\n            </option>\n          ))}\n        </select>\n\n        {/* Bathrooms */}\n        <select\n          className=\"dv-filter-bar__select\"\n          value={filters.bathrooms ?? \"\"}\n          onChange={(e) =>\n            setFilters({\n              ...filters,\n              bathrooms: e.target.value ? Number(e.target.value) : null,\n            })\n          }\n        >\n          <option value=\"\">Bathrooms</option>\n          {uniqueBathrooms.map((b) => (\n            <option key={b} value={b}>\n              {b} Bath{b !== 1 ? \"s\" : \"\"}\n            </option>\n          ))}\n        </select>\n\n        {/* Area Range */}\n        <select\n          className=\"dv-filter-bar__select\"\n          value={\n            filters.minArea !== null && filters.maxArea !== null\n              ? `${filters.minArea}-${filters.maxArea}`\n              : \"\"\n          }\n          onChange={(e) => {\n            if (!e.target.value) {\n              setFilters({ ...filters, minArea: null, maxArea: null });\n            } else {\n              const [min, max] = e.target.value.split(\"-\").map(Number);\n              setFilters({ ...filters, minArea: min, maxArea: max });\n            }\n          }}\n        >\n          <option value=\"\">Sqft Range</option>\n          {AREA_RANGES.map((r) => (\n            <option key={r.label} value={`${r.min}-${r.max}`}>\n              {r.label}\n            </option>\n          ))}\n        </select>\n\n        {/* Style */}\n        <select\n          className=\"dv-filter-bar__select\"\n          value={filters.style ?? \"\"}\n          onChange={(e) =>\n            setFilters({\n              ...filters,\n              style: (e.target.value || null) as typeof filters.style,\n            })\n          }\n        >\n          <option value=\"\">Style</option>\n          {uniqueStyles.map((s) => (\n            <option key={s} value={s}>\n              {STYLE_LABELS[s]}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      <div className=\"dv-filter-bar__meta\">\n        <span className=\"dv-filter-bar__count\">\n          Showing {filteredCount} of {totalCount} plans\n        </span>\n        {active && (\n          <button className=\"dv-filter-bar__clear\" onClick={clearFilters}>\n            <X size={14} />\n            Clear\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Heart } from \"lucide-react\";\nimport type { FavoriteButtonProps } from \"../types\";\n\nexport const FavoriteButton: React.FC<FavoriteButtonProps> = ({\n  planId,\n  isFavorite,\n  onToggle,\n  size = \"md\",\n}) => {\n  const iconSize = size === \"sm\" ? 16 : size === \"lg\" ? 24 : 20;\n\n  return (\n    <button\n      className={`dv-favorite-btn dv-favorite-btn--${size} ${\n        isFavorite ? \"dv-favorite-btn--active\" : \"\"\n      }`}\n      onClick={(e) => {\n        e.stopPropagation();\n        onToggle(planId);\n      }}\n      aria-label={isFavorite ? \"Remove from favorites\" : \"Add to favorites\"}\n    >\n      <Heart size={iconSize} fill={isFavorite ? \"currentColor\" : \"none\"} />\n    </button>\n  );\n};\n","import React, { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Home, Bath, Square, Sparkles, Star } from \"lucide-react\";\nimport { FavoriteButton } from \"./FavoriteButton\";\nimport type { PlanCardProps } from \"../types\";\n\nconst cardVariants = {\n  hidden: { opacity: 0, y: 24 },\n  visible: { opacity: 1, y: 0, transition: { duration: 0.4, ease: \"easeOut\" } },\n};\n\nexport const PlanCard: React.FC<PlanCardProps> = ({\n  plan,\n  onSelect,\n  onFavorite,\n  isFavorite = false,\n}) => {\n  const [imageIndex, setImageIndex] = useState(0);\n  const isPopular = (plan.vote_count ?? 0) > 3;\n  const isNew = plan.is_new === true;\n\n  const allImages = [plan.image_url, ...(plan.interior_urls ?? [])];\n  const hasMultipleImages = allImages.length > 1;\n\n  return (\n    <motion.div\n      className=\"dv-plan-card\"\n      variants={cardVariants}\n      viewport={{ once: true, margin: \"-50px\" }}\n    >\n      {/* Image area */}\n      <div className=\"dv-plan-card__image\" onClick={() => onSelect(plan)}>\n        <img\n          src={allImages[imageIndex]}\n          alt={plan.title}\n          className=\"dv-plan-card__img\"\n          loading=\"lazy\"\n        />\n        <div className=\"dv-plan-card__image-gradient\" />\n\n        {/* Badges  top left */}\n        {(isPopular || isNew) && (\n          <div className=\"dv-plan-card__badges\">\n            {isPopular && (\n              <span className=\"dv-plan-card__badge dv-plan-card__badge--popular\">\n                <Star size={10} /> POPULAR\n              </span>\n            )}\n            {isNew && (\n              <span className=\"dv-plan-card__badge dv-plan-card__badge--new\">\n                NEW\n              </span>\n            )}\n          </div>\n        )}\n\n        {/* AI badge  top right */}\n        <span className=\"dv-plan-card__ai-badge\">\n          <Sparkles size={10} /> AI Customizable\n        </span>\n\n        {/* Favorite button  on image, below AI badge */}\n        {onFavorite && (\n          <div className=\"dv-plan-card__favorite\">\n            <FavoriteButton\n              planId={plan.id}\n              isFavorite={isFavorite}\n              onToggle={onFavorite}\n              size=\"sm\"\n            />\n          </div>\n        )}\n\n        {/* Carousel dots */}\n        {hasMultipleImages && (\n          <div className=\"dv-plan-card__dots\">\n            {allImages.map((_, i) => (\n              <button\n                key={i}\n                className={`dv-plan-card__dot ${\n                  i === imageIndex ? \"dv-plan-card__dot--active\" : \"\"\n                }`}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  setImageIndex(i);\n                }}\n                aria-label={`Image ${i + 1}`}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Content */}\n      <div className=\"dv-plan-card__content\">\n        <h3 className=\"dv-plan-card__title\">{plan.title}</h3>\n\n        <div className=\"dv-plan-card__specs\">\n          <span className=\"dv-plan-card__spec\">\n            <Home size={14} />\n            {plan.beds} Bed{plan.beds !== 1 ? \"s\" : \"\"}\n          </span>\n          <span className=\"dv-plan-card__spec\">\n            <Bath size={14} />\n            {plan.baths} Bath{plan.baths !== 1 ? \"s\" : \"\"}\n          </span>\n          <span className=\"dv-plan-card__spec\">\n            <Square size={14} />\n            {plan.area.toLocaleString()} sqft\n          </span>\n        </div>\n\n        {/* Tags */}\n        {plan.tags && plan.tags.length > 0 && (\n          <div className=\"dv-plan-card__tags\">\n            {plan.tags.slice(0, 3).map((tag) => (\n              <span key={tag} className=\"dv-plan-card__tag\">\n                {tag}\n              </span>\n            ))}\n          </div>\n        )}\n\n        {/* Full-width CTA */}\n        <button className=\"dv-plan-card__cta\" onClick={() => onSelect(plan)}>\n          <Sparkles size={14} />\n          Customize\n        </button>\n      </div>\n    </motion.div>\n  );\n};\n","import React, { useRef } from \"react\";\nimport { ArrowRight, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { PlanCard } from \"./PlanCard\";\nimport type { FeaturedRowProps } from \"../types\";\n\nexport const FeaturedRow: React.FC<FeaturedRowProps> = ({\n  title,\n  plans,\n  onPlanSelect,\n  onFavorite,\n  isFavorite,\n}) => {\n  const scrollRef = useRef<HTMLDivElement>(null);\n\n  const scroll = (direction: \"left\" | \"right\") => {\n    if (!scrollRef.current) return;\n    const amount = scrollRef.current.clientWidth * 0.8;\n    scrollRef.current.scrollBy({\n      left: direction === \"left\" ? -amount : amount,\n      behavior: \"smooth\",\n    });\n  };\n\n  if (plans.length === 0) return null;\n\n  return (\n    <section className=\"dv-featured-row\">\n      <div className=\"dv-featured-row__header\">\n        <h2 className=\"dv-featured-row__title\">{title}</h2>\n        <span className=\"dv-featured-row__view-all\">\n          View all <ArrowRight size={16} />\n        </span>\n      </div>\n\n      <div className=\"dv-featured-row__wrapper\">\n        <button\n          className=\"dv-featured-row__arrow dv-featured-row__arrow--left\"\n          onClick={() => scroll(\"left\")}\n          aria-label=\"Scroll left\"\n        >\n          <ChevronLeft size={20} />\n        </button>\n\n        <div className=\"dv-featured-row__scroll\" ref={scrollRef}>\n          {plans.map((plan) => (\n            <div key={plan.id} className=\"dv-featured-row__item\">\n              <PlanCard\n                plan={plan}\n                onSelect={onPlanSelect}\n                onFavorite={onFavorite}\n                isFavorite={isFavorite(plan.id)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <button\n          className=\"dv-featured-row__arrow dv-featured-row__arrow--right\"\n          onClick={() => scroll(\"right\")}\n          aria-label=\"Scroll right\"\n        >\n          <ChevronRight size={20} />\n        </button>\n      </div>\n    </section>\n  );\n};\n","import { useCallback, useEffect, useState } from \"react\";\n\nconst STORAGE_KEY = \"dv-favorites\";\n\nfunction readFavorites(): string[] {\n  if (typeof window === \"undefined\") return [];\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    return stored ? JSON.parse(stored) : [];\n  } catch {\n    return [];\n  }\n}\n\nfunction writeFavorites(ids: string[]): void {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(ids));\n  } catch {\n    // localStorage may be full or disabled\n  }\n}\n\nexport function useFavorites() {\n  const [favorites, setFavorites] = useState<string[]>(readFavorites);\n\n  // Persist to localStorage whenever favorites change\n  useEffect(() => {\n    writeFavorites(favorites);\n  }, [favorites]);\n\n  const toggleFavorite = useCallback((planId: string) => {\n    setFavorites((prev) =>\n      prev.includes(planId)\n        ? prev.filter((id) => id !== planId)\n        : [...prev, planId]\n    );\n  }, []);\n\n  const isFavorite = useCallback(\n    (planId: string) => favorites.includes(planId),\n    [favorites]\n  );\n\n  return {\n    favorites,\n    toggleFavorite,\n    isFavorite,\n    favoritesCount: favorites.length,\n  };\n}\n","import React from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Layers } from \"lucide-react\";\nimport { CategoryTiles } from \"./CategoryTiles\";\nimport { FilterBar } from \"./FilterBar\";\nimport { FeaturedRow } from \"./FeaturedRow\";\nimport { PlanCard } from \"./PlanCard\";\nimport { usePlans } from \"../hooks/usePlans\";\nimport { useFavorites } from \"../hooks/useFavorites\";\nimport type { ArchiveGridProps } from \"../types\";\n\nfunction SkeletonCard() {\n  return (\n    <div className=\"dv-plan-card dv-plan-card--skeleton\">\n      <div className=\"dv-plan-card__image dv-skeleton\" />\n      <div className=\"dv-plan-card__content\">\n        <div className=\"dv-skeleton dv-skeleton--text dv-skeleton--title\" />\n        <div className=\"dv-skeleton dv-skeleton--text dv-skeleton--specs\" />\n        <div className=\"dv-skeleton dv-skeleton--text dv-skeleton--tags\" />\n      </div>\n    </div>\n  );\n}\n\nconst hasAnyFilter = (filters: {\n  category: unknown;\n  bedrooms: unknown;\n  bathrooms: unknown;\n  style: unknown;\n  minArea: unknown;\n}): boolean =>\n  filters.category !== null ||\n  filters.bedrooms !== null ||\n  filters.bathrooms !== null ||\n  filters.style !== null ||\n  filters.minArea !== null;\n\nexport const ArchiveGrid: React.FC<ArchiveGridProps> = ({ onPlanSelect }) => {\n  const {\n    plans,\n    filteredPlans,\n    featuredPlans,\n    loading,\n    error,\n    filters,\n    setFilters,\n    clearFilters,\n    uniqueBedrooms,\n    uniqueBathrooms,\n    areaRange,\n    uniqueStyles,\n  } = usePlans();\n\n  const { toggleFavorite, isFavorite } = useFavorites();\n\n  const handleCategorySelect = (category: typeof filters.category) => {\n    setFilters({ ...filters, category });\n  };\n\n  if (error) {\n    return (\n      <div className=\"dv-archive-grid dv-archive-grid--error\">\n        <p>Failed to load plans: {error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"dv-archive-grid\">\n      {/* Category tiles */}\n      <CategoryTiles\n        activeCategory={filters.category}\n        onSelect={handleCategorySelect}\n      />\n\n      {/* Featured row  only when no filters are active */}\n      {!hasAnyFilter(filters) && featuredPlans.length > 0 && (\n        <FeaturedRow\n          title=\"Featured Plans\"\n          plans={featuredPlans}\n          onPlanSelect={onPlanSelect}\n          onFavorite={toggleFavorite}\n          isFavorite={isFavorite}\n        />\n      )}\n\n      {/* Filter bar */}\n      <FilterBar\n        filters={filters}\n        setFilters={setFilters}\n        clearFilters={clearFilters}\n        uniqueBedrooms={uniqueBedrooms}\n        uniqueBathrooms={uniqueBathrooms}\n        areaRange={areaRange}\n        uniqueStyles={uniqueStyles}\n        totalCount={plans.length}\n        filteredCount={filteredPlans.length}\n      />\n\n      {/* Plan grid */}\n      {loading ? (\n        <div className=\"dv-plan-grid\">\n          {Array.from({ length: 6 }).map((_, i) => (\n            <SkeletonCard key={i} />\n          ))}\n        </div>\n      ) : filteredPlans.length === 0 ? (\n        <div className=\"dv-archive-grid__empty\">\n          <Layers size={48} />\n          <h3>No plans found</h3>\n          <p>Try adjusting your filters or browse all categories.</p>\n          <button className=\"dv-btn dv-btn--outline\" onClick={clearFilters}>\n            Clear Filters\n          </button>\n        </div>\n      ) : (\n        <motion.div\n          className=\"dv-plan-grid\"\n          initial=\"hidden\"\n          animate=\"visible\"\n          variants={{\n            visible: { transition: { staggerChildren: 0.08 } },\n          }}\n        >\n          {filteredPlans.map((plan) => (\n            <PlanCard\n              key={plan.id}\n              plan={plan}\n              onSelect={onPlanSelect}\n              onFavorite={toggleFavorite}\n              isFavorite={isFavorite(plan.id)}\n            />\n          ))}\n        </motion.div>\n      )}\n    </div>\n  );\n};\n","//  Floor Plan (matches Supabase website_floor_plans) \n\nexport type FloorPlanStyle =\n  | \"modern\"\n  | \"traditional\"\n  | \"rustic\"\n  | \"contemporary\"\n  | \"farmhouse\"\n  | \"hill_country\";\n\nexport type FloorPlanCategory =\n  | \"barndominium\"\n  | \"ranch\"\n  | \"estate\"\n  | \"cabin\"\n  | \"shop_house\"\n  | \"starter\";\n\nexport type PriceTier = \"economy\" | \"standard\" | \"luxury\";\n\nexport interface FloorPlan {\n  id: string;\n  title: string;\n  description: string | null;\n  beds: number;\n  baths: number;\n  area: number;\n  image_url: string;\n  floor_plan_url: string | null;\n  interior_urls: string[] | null;\n  features: string[];\n  style: FloorPlanStyle | null;\n  category: FloorPlanCategory | null;\n  price_tier: PriceTier | null;\n  tags: string[] | null;\n  featured: boolean;\n  is_new: boolean;\n  vote_count: number;\n  click_count: number;\n  display_order: number;\n  created_at: string;\n}\n\n//  Filters \n\nexport interface PlanFilters {\n  bedrooms: number | null;\n  bathrooms: number | null;\n  minArea: number | null;\n  maxArea: number | null;\n  style: FloorPlanStyle | null;\n  category: FloorPlanCategory | null;\n}\n\n//  Session \n\nexport interface DesignSession {\n  id: string;\n  anonymousId: string;\n  planId: string;\n  builderSlug: string;\n  modifications: Modification[];\n  stylePref: string | null;\n  capturedAt: string | null;\n  contactId: string | null;\n}\n\n//  Modification \n\nexport interface Modification {\n  type: \"style_swap\" | \"floor_plan_edit\" | \"wishlist_item\";\n  prompt: string | null;\n  stylePreset: string | null;\n  resultUrl: string;\n  originalUrl: string;\n  timestamp: string;\n}\n\n//  Lead Capture \n\nexport interface LeadCaptureData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone: string;\n  planId: string;\n  planTitle: string;\n  planSpecs: {\n    beds: number;\n    baths: number;\n    area: number;\n  };\n  modifications: Modification[];\n  favorites: string[];\n  stylePref: string | null;\n  sessionDuration: number;\n  plansViewed: number;\n  fbclid?: string;\n  fbp?: string;\n  fbc?: string;\n  client_user_agent?: string;\n}\n\n//  Style Presets \n\nexport interface StylePreset {\n  id: string;\n  label: string;\n  description: string;\n}\n\nexport const DEFAULT_STYLE_PRESETS: StylePreset[] = [\n  { id: \"modern\", label: \"Modern\", description: \"Clean lines, large windows, flat roofs\" },\n  { id: \"rustic\", label: \"Rustic\", description: \"Natural materials, wood beams, stone accents\" },\n  { id: \"hill_country\", label: \"Hill Country\", description: \"Texas limestone, metal roofing, wide porches\" },\n  { id: \"traditional\", label: \"Traditional\", description: \"Classic proportions, symmetrical facades\" },\n  { id: \"farmhouse\", label: \"Farmhouse\", description: \"Board-and-batten siding, wraparound porches\" },\n  { id: \"contemporary\", label: \"Contemporary\", description: \"Mixed materials, asymmetric design, open plans\" },\n];\n\n//  AI Interaction \n\nexport interface AIInteractionResult {\n  success: boolean;\n  resultUrl: string | null;\n  cached: boolean;\n  error: string | null;\n  remainingFree: number;\n}\n\n//  Config \n\nexport interface DesignVaultConfig {\n  builderSlug: string;\n  brandColor: string;\n  brandColorLight?: string;\n  ctaText?: string;\n  apiBaseUrl: string;\n  crmWebhookUrl?: string;\n  metaPixelId?: string;\n  trackingEndpoint?: string;\n  maxFreeInteractions?: number;\n  enableFloorPlanEdit?: boolean;\n  enableStyleSwap?: boolean;\n  enableFavorites?: boolean;\n  enableSimilarPlans?: boolean;\n  schedulerUrl?: string;\n  attribution?: {\n    show: boolean;\n    text: string;\n    url: string;\n  };\n}\n\n//  Component Props \n\nexport interface DesignVaultProps {\n  config: DesignVaultConfig;\n  className?: string;\n}\n\nexport interface ArchiveGridProps {\n  onPlanSelect: (plan: FloorPlan) => void;\n}\n\nexport interface PlanCardProps {\n  plan: FloorPlan;\n  onSelect: (plan: FloorPlan) => void;\n  onFavorite?: (planId: string) => void;\n  isFavorite?: boolean;\n}\n\nexport interface PlanDetailProps {\n  plan: FloorPlan;\n  isOpen: boolean;\n  onClose: () => void;\n  config: DesignVaultConfig;\n  allPlans?: FloorPlan[];\n  onPlanSwitch?: (plan: FloorPlan) => void;\n}\n\nexport interface AIToolsPanelProps {\n  plan: FloorPlan;\n  config: DesignVaultConfig;\n  heroUrl: string;\n  originalHeroUrl: string;\n  imageType: \"exterior\" | \"interior\";\n  floorPlanUrl: string;\n  originalFloorPlanUrl: string;\n  hasFloorPlanResult: boolean;\n  showOriginalFloorPlan: boolean;\n  onToggleFloorPlanOriginal: (show: boolean) => void;\n  onResult: (result: {\n    newUrl: string;\n    originalUrl: string;\n    type: \"style_swap\" | \"floor_plan_edit\";\n  }) => void;\n  onProcessingChange: (isProcessing: boolean) => void;\n}\n\nexport interface LeadCaptureModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSubmit?: () => void;\n  isSubmitting?: boolean;\n  plan: FloorPlan;\n  modifications: Modification[];\n  config: DesignVaultConfig;\n}\n\nexport interface CategoryTilesProps {\n  activeCategory: FloorPlanCategory | null;\n  onSelect: (category: FloorPlanCategory | null) => void;\n}\n\nexport interface FilterBarProps {\n  filters: PlanFilters;\n  setFilters: (filters: PlanFilters) => void;\n  clearFilters: () => void;\n  uniqueBedrooms: number[];\n  uniqueBathrooms: number[];\n  areaRange: { min: number; max: number };\n  uniqueStyles: FloorPlanStyle[];\n  totalCount: number;\n  filteredCount: number;\n}\n\nexport interface FeaturedRowProps {\n  title: string;\n  plans: FloorPlan[];\n  onPlanSelect: (plan: FloorPlan) => void;\n  onFavorite: (planId: string) => void;\n  isFavorite: (planId: string) => boolean;\n}\n\nexport interface StyleSwapButtonsProps {\n  planId: string;\n  currentStyle: string | null;\n  onSwap: (presetId: string) => Promise<void>;\n  isProcessing: boolean;\n  activePreset: string | null;\n}\n\nexport interface FloorPlanEditorProps {\n  planId: string;\n  floorPlanUrl: string;\n  originalFloorPlanUrl: string;\n  hasFloorPlanResult: boolean;\n  showOriginalFloorPlan: boolean;\n  onToggleFloorPlanOriginal: (show: boolean) => void;\n  wishlistItems: string[];\n  onWishlistAdd: (text: string) => void;\n  onWishlistRemove: (index: number) => void;\n  onPreviewAI: () => Promise<void>;\n  isProcessing: boolean;\n}\n\nexport interface SimilarPlansProps {\n  currentPlan: FloorPlan;\n  allPlans: FloorPlan[];\n  onPlanSelect: (plan: FloorPlan) => void;\n}\n\nexport interface FavoriteButtonProps {\n  planId: string;\n  isFavorite: boolean;\n  onToggle: (planId: string) => void;\n  size?: \"sm\" | \"md\" | \"lg\";\n}\n","import React from \"react\";\nimport { Loader2 } from \"lucide-react\";\nimport { DEFAULT_STYLE_PRESETS } from \"../types\";\nimport type { StyleSwapButtonsProps } from \"../types\";\n\nexport const StyleSwapButtons: React.FC<StyleSwapButtonsProps> = ({\n  currentStyle,\n  onSwap,\n  isProcessing,\n  activePreset,\n}) => {\n  return (\n    <div className=\"dv-style-swap\">\n      <h4 className=\"dv-style-swap__label\">Style Swap</h4>\n      <div className=\"dv-style-swap__grid\">\n        {DEFAULT_STYLE_PRESETS.map((preset) => {\n          const isActive = activePreset === preset.id;\n          const isOriginal = currentStyle === preset.id && !activePreset;\n          const isThisProcessing = isProcessing && isActive;\n\n          return (\n            <button\n              key={preset.id}\n              className={`dv-style-swap__btn ${\n                isActive || isOriginal ? \"dv-style-swap__btn--active\" : \"\"\n              }`}\n              onClick={() => onSwap(preset.id)}\n              disabled={isProcessing}\n              title={preset.description}\n            >\n              <span className=\"dv-style-swap__btn-label\">{preset.label}</span>\n              {isThisProcessing && (\n                <Loader2 size={14} className=\"dv-style-swap__spinner\" />\n              )}\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { X } from \"lucide-react\";\n\ninterface ImageLightboxProps {\n  src: string;\n  alt: string;\n  isOpen: boolean;\n  onClose: () => void;\n  images?: { url: string; label: string }[];\n  activeIndex?: number;\n  onIndexChange?: (index: number) => void;\n}\n\nexport const ImageLightbox: React.FC<ImageLightboxProps> = ({\n  src,\n  alt,\n  isOpen,\n  onClose,\n  images,\n  activeIndex = 0,\n  onIndexChange,\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const imgRef = useRef<HTMLImageElement>(null);\n\n  // Transform state\n  const [scale, setScale] = useState(1);\n  const [translate, setTranslate] = useState({ x: 0, y: 0 });\n\n  // Touch tracking refs\n  const lastTouchRef = useRef<{ x: number; y: number } | null>(null);\n  const lastPinchDistRef = useRef<number | null>(null);\n  const lastPinchCenterRef = useRef<{ x: number; y: number } | null>(null);\n\n  // Swipe-to-navigate tracking (only at 1x zoom)\n  const swipeStartRef = useRef<{ x: number; y: number } | null>(null);\n  const swipeDeltaRef = useRef(0);\n  const wasPinchingRef = useRef(false);\n\n  const canSwipe = !!images && images.length > 1 && !!onIndexChange;\n  const displaySrc = images?.[activeIndex]?.url ?? src;\n\n  // Reset on open/close or image change\n  useEffect(() => {\n    if (isOpen) {\n      setScale(1);\n      setTranslate({ x: 0, y: 0 });\n    }\n  }, [isOpen, activeIndex]);\n\n  // Escape key closes\n  useEffect(() => {\n    if (!isOpen) return;\n    const handler = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") onClose();\n    };\n    window.addEventListener(\"keydown\", handler);\n    return () => window.removeEventListener(\"keydown\", handler);\n  }, [isOpen, onClose]);\n\n  // Lock body scroll when open\n  useEffect(() => {\n    if (isOpen) {\n      document.body.style.overflow = \"hidden\";\n    }\n    return () => {\n      document.body.style.overflow = \"\";\n    };\n  }, [isOpen]);\n\n  // Clamp translate so image edges don't go past viewport center\n  const clampTranslate = useCallback(\n    (tx: number, ty: number, s: number) => {\n      const img = imgRef.current;\n      const container = containerRef.current;\n      if (!img || !container) return { x: tx, y: ty };\n\n      const imgW = img.naturalWidth || img.offsetWidth;\n      const imgH = img.naturalHeight || img.offsetHeight;\n      const cW = container.clientWidth;\n      const cH = container.clientHeight;\n\n      // Compute displayed image size (object-fit: contain)\n      const imgAspect = imgW / imgH;\n      const cAspect = cW / cH;\n      let displayW: number, displayH: number;\n      if (imgAspect > cAspect) {\n        displayW = cW;\n        displayH = cW / imgAspect;\n      } else {\n        displayH = cH;\n        displayW = cH * imgAspect;\n      }\n\n      const scaledW = displayW * s;\n      const scaledH = displayH * s;\n\n      const maxX = Math.max(0, (scaledW - cW) / 2);\n      const maxY = Math.max(0, (scaledH - cH) / 2);\n\n      return {\n        x: Math.min(maxX, Math.max(-maxX, tx)),\n        y: Math.min(maxY, Math.max(-maxY, ty)),\n      };\n    },\n    []\n  );\n\n  // Get distance between two touches\n  const getTouchDist = (t1: React.Touch, t2: React.Touch) => {\n    const dx = t1.clientX - t2.clientX;\n    const dy = t1.clientY - t2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  };\n\n  const getTouchCenter = (t1: React.Touch, t2: React.Touch) => ({\n    x: (t1.clientX + t2.clientX) / 2,\n    y: (t1.clientY + t2.clientY) / 2,\n  });\n\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    if (e.touches.length === 1) {\n      lastTouchRef.current = {\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY,\n      };\n      swipeStartRef.current = {\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY,\n      };\n      swipeDeltaRef.current = 0;\n      wasPinchingRef.current = false;\n      lastPinchDistRef.current = null;\n      lastPinchCenterRef.current = null;\n    } else if (e.touches.length === 2) {\n      lastTouchRef.current = null;\n      swipeStartRef.current = null;\n      wasPinchingRef.current = true;\n      lastPinchDistRef.current = getTouchDist(e.touches[0], e.touches[1]);\n      lastPinchCenterRef.current = getTouchCenter(e.touches[0], e.touches[1]);\n    }\n  }, []);\n\n  const handleTouchMove = useCallback(\n    (e: React.TouchEvent) => {\n      e.preventDefault();\n\n      if (e.touches.length === 2) {\n        // Pinch zoom\n        const dist = getTouchDist(e.touches[0], e.touches[1]);\n        const center = getTouchCenter(e.touches[0], e.touches[1]);\n\n        if (lastPinchDistRef.current != null) {\n          const ratio = dist / lastPinchDistRef.current;\n          setScale((prev) => {\n            const next = Math.min(5, Math.max(1, prev * ratio));\n            // If zooming back to 1, reset translate\n            if (next <= 1) {\n              setTranslate({ x: 0, y: 0 });\n            }\n            return next;\n          });\n        }\n\n        if (lastPinchCenterRef.current != null) {\n          const dx = center.x - lastPinchCenterRef.current.x;\n          const dy = center.y - lastPinchCenterRef.current.y;\n          setTranslate((prev) =>\n            clampTranslate(prev.x + dx, prev.y + dy, scale)\n          );\n        }\n\n        lastPinchDistRef.current = dist;\n        lastPinchCenterRef.current = center;\n      } else if (e.touches.length === 1) {\n        if (scale > 1) {\n          // Single-finger pan (only when zoomed)\n          if (lastTouchRef.current) {\n            const dx = e.touches[0].clientX - lastTouchRef.current.x;\n            const dy = e.touches[0].clientY - lastTouchRef.current.y;\n            setTranslate((prev) =>\n              clampTranslate(prev.x + dx, prev.y + dy, scale)\n            );\n          }\n          lastTouchRef.current = {\n            x: e.touches[0].clientX,\n            y: e.touches[0].clientY,\n          };\n        } else if (canSwipe && swipeStartRef.current && !wasPinchingRef.current) {\n          // Track horizontal swipe delta at 1x zoom\n          swipeDeltaRef.current =\n            e.touches[0].clientX - swipeStartRef.current.x;\n        }\n      }\n    },\n    [scale, clampTranslate, canSwipe]\n  );\n\n  const handleTouchEnd = useCallback(\n    (e: React.TouchEvent) => {\n      if (e.touches.length === 0) {\n        // Check for swipe-to-navigate at 1x zoom\n        if (\n          canSwipe &&\n          scale <= 1.1 &&\n          !wasPinchingRef.current &&\n          Math.abs(swipeDeltaRef.current) > 50\n        ) {\n          if (swipeDeltaRef.current < -50 && activeIndex < images!.length - 1) {\n            onIndexChange!(activeIndex + 1);\n          } else if (swipeDeltaRef.current > 50 && activeIndex > 0) {\n            onIndexChange!(activeIndex - 1);\n          }\n          // Reset refs and skip the tap-to-close logic\n          swipeDeltaRef.current = 0;\n          swipeStartRef.current = null;\n          lastTouchRef.current = null;\n          lastPinchDistRef.current = null;\n          lastPinchCenterRef.current = null;\n          return;\n        }\n\n        lastTouchRef.current = null;\n        lastPinchDistRef.current = null;\n        lastPinchCenterRef.current = null;\n        swipeStartRef.current = null;\n        swipeDeltaRef.current = 0;\n\n        // Snap back to 1x if close\n        if (scale < 1.1) {\n          setScale(1);\n          setTranslate({ x: 0, y: 0 });\n        }\n      } else if (e.touches.length === 1) {\n        // Went from pinch to single finger  start panning\n        lastTouchRef.current = {\n          x: e.touches[0].clientX,\n          y: e.touches[0].clientY,\n        };\n        lastPinchDistRef.current = null;\n        lastPinchCenterRef.current = null;\n      }\n    },\n    [scale, canSwipe, activeIndex, images, onIndexChange]\n  );\n\n  // Tap to close (only when not zoomed and not swiping)\n  const handleClick = useCallback(() => {\n    if (scale <= 1.1) {\n      onClose();\n    }\n  }, [scale, onClose]);\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"dv-lightbox-overlay\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.2 }}\n        >\n          {/* Close button */}\n          <button\n            className=\"dv-lightbox-overlay__close\"\n            onClick={onClose}\n            aria-label=\"Close\"\n          >\n            <X size={24} />\n          </button>\n\n          {/* Image container  JS handles pinch zoom + single-finger pan + swipe nav */}\n          <div\n            className=\"dv-lightbox-scroll\"\n            ref={containerRef}\n            onTouchStart={handleTouchStart}\n            onTouchMove={handleTouchMove}\n            onTouchEnd={handleTouchEnd}\n            onClick={handleClick}\n            style={{ touchAction: \"none\" }}\n          >\n            <img\n              ref={imgRef}\n              className=\"dv-lightbox-scroll__img\"\n              src={displaySrc}\n              alt={alt}\n              draggable={false}\n              style={{\n                transform: `translate(${translate.x}px, ${translate.y}px) scale(${scale})`,\n                transition: scale <= 1 ? \"transform 0.2s ease\" : \"none\",\n              }}\n            />\n          </div>\n\n          {/* Dot indicators */}\n          {canSwipe && (\n            <div className=\"dv-lightbox-dots\">\n              {images!.map((_, i) => (\n                <button\n                  key={i}\n                  className={`dv-lightbox-dots__dot ${\n                    i === activeIndex ? \"dv-lightbox-dots__dot--active\" : \"\"\n                  }`}\n                  onClick={() => onIndexChange!(i)}\n                  aria-label={`Image ${i + 1}`}\n                />\n              ))}\n            </div>\n          )}\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n","import React, { useState } from \"react\";\nimport { Plus, Sparkles, Check, X, Loader2, Search } from \"lucide-react\";\nimport { ImageLightbox } from \"./ImageLightbox\";\nimport type { FloorPlanEditorProps } from \"../types\";\n\nexport const FloorPlanEditor: React.FC<FloorPlanEditorProps> = ({\n  floorPlanUrl,\n  originalFloorPlanUrl,\n  hasFloorPlanResult,\n  showOriginalFloorPlan,\n  onToggleFloorPlanOriginal,\n  wishlistItems,\n  onWishlistAdd,\n  onWishlistRemove,\n  onPreviewAI,\n  isProcessing,\n}) => {\n  const [input, setInput] = useState(\"\");\n  const [lightboxOpen, setLightboxOpen] = useState(false);\n\n  const handleAdd = () => {\n    const text = input.trim();\n    if (!text) return;\n    onWishlistAdd(text);\n    setInput(\"\");\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleAdd();\n    }\n  };\n\n  const displayUrl = showOriginalFloorPlan ? originalFloorPlanUrl : floorPlanUrl;\n\n  return (\n    <div className=\"dv-wishlist\">\n      {/* Floor plan image with before/after toggle */}\n      {displayUrl && (\n        <div className=\"dv-wishlist__preview\">\n          <div\n            className=\"dv-wishlist__preview-clickable\"\n            onClick={() => setLightboxOpen(true)}\n            role=\"button\"\n            tabIndex={0}\n            onKeyDown={(e) => { if (e.key === \"Enter\") setLightboxOpen(true); }}\n          >\n            <img\n              src={displayUrl}\n              alt={hasFloorPlanResult && !showOriginalFloorPlan ? \"AI-modified floor plan\" : \"Current floor plan\"}\n              className=\"dv-wishlist__preview-img\"\n            />\n            <div className=\"dv-wishlist__preview-zoom\">\n              <Search size={16} />\n            </div>\n          </div>\n          {hasFloorPlanResult && (\n            <div className=\"dv-wishlist__compare\">\n              <button\n                className={`dv-wishlist__compare-btn ${\n                  !showOriginalFloorPlan ? \"dv-wishlist__compare-btn--active\" : \"\"\n                }`}\n                onClick={() => onToggleFloorPlanOriginal(false)}\n              >\n                AI Generated\n              </button>\n              <button\n                className={`dv-wishlist__compare-btn ${\n                  showOriginalFloorPlan ? \"dv-wishlist__compare-btn--active\" : \"\"\n                }`}\n                onClick={() => onToggleFloorPlanOriginal(true)}\n              >\n                Original\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n\n      <h4 className=\"dv-wishlist__label\">Floor Plan Wishlist</h4>\n\n      {/* Input area */}\n      <div className=\"dv-wishlist__input-wrap\">\n        <textarea\n          className=\"dv-wishlist__input\"\n          placeholder=\"What would you change? E.g. 'Add a 4th bedroom', 'Bigger garage', 'Open concept kitchen'...\"\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyDown={handleKeyDown}\n          disabled={isProcessing}\n          rows={2}\n        />\n        <button\n          className=\"dv-wishlist__add-btn\"\n          onClick={handleAdd}\n          disabled={!input.trim() || isProcessing}\n        >\n          <Plus size={14} />\n          Add to Wishlist\n        </button>\n      </div>\n\n      {/* Wishlist items */}\n      {wishlistItems.length > 0 && (\n        <div className=\"dv-wishlist__items\">\n          {wishlistItems.map((item, i) => (\n            <div key={i} className=\"dv-wishlist__item\">\n              <Check size={12} className=\"dv-wishlist__item-check\" />\n              <span className=\"dv-wishlist__item-text\">{item}</span>\n              <button\n                className=\"dv-wishlist__item-remove\"\n                onClick={() => onWishlistRemove(i)}\n                aria-label=\"Remove\"\n                disabled={isProcessing}\n              >\n                <X size={12} />\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Preview AI button */}\n      {wishlistItems.length > 0 && (\n        <div className=\"dv-wishlist__ai-section\">\n          <button\n            className=\"dv-wishlist__ai-btn\"\n            onClick={onPreviewAI}\n            disabled={isProcessing}\n          >\n            {isProcessing ? (\n              <Loader2 size={14} className=\"dv-wishlist__spinner\" />\n            ) : (\n              <Sparkles size={14} />\n            )}\n            {isProcessing ? \"Generating...\" : \"Preview AI Suggestion\"}\n          </button>\n          <p className=\"dv-wishlist__ai-disclaimer\">\n            Results are AI-generated and may not be exact\n          </p>\n        </div>\n      )}\n      <ImageLightbox\n        src={displayUrl}\n        alt=\"Floor plan\"\n        isOpen={lightboxOpen}\n        onClose={() => setLightboxOpen(false)}\n      />\n    </div>\n  );\n};\n","import type { FloorPlan } from \"../types\";\n\n//  Global type declarations \n\ntype FbqMethod = \"track\" | \"trackCustom\" | \"init\";\n\ninterface Fbq {\n  (method: FbqMethod, event: string, params?: Record<string, unknown>): void;\n}\n\ndeclare global {\n  interface Window {\n    fbq?: Fbq;\n    dataLayer?: Record<string, unknown>[];\n  }\n}\n\n//  Helpers \n\nfunction fbq(\n  method: FbqMethod,\n  event: string,\n  params?: Record<string, unknown>\n): void {\n  if (typeof window === \"undefined\" || !window.fbq) return;\n  window.fbq(method, event, params);\n}\n\nfunction pushDataLayer(event: string, data?: Record<string, unknown>): void {\n  if (typeof window === \"undefined\") return;\n  window.dataLayer = window.dataLayer ?? [];\n  window.dataLayer.push({ event, ...data });\n}\n\nfunction planData(plan: FloorPlan): Record<string, unknown> {\n  return {\n    content_name: plan.title,\n    content_ids: [plan.id],\n    content_type: \"floor_plan\",\n    content_category: plan.category ?? \"uncategorized\",\n    style: plan.style ?? \"unknown\",\n    beds: plan.beds,\n    baths: plan.baths,\n    sqft: plan.area,\n    price_tier: plan.price_tier ?? \"standard\",\n  };\n}\n\n//  Meta Pixel \n\nexport function trackPageView(\n  pixelId: string,\n  anonymousId?: string,\n  trackingEndpoint?: string\n): void {\n  fbq(\"track\", \"PageView\");\n\n  pushDataLayer(\"dv_page_view\", {\n    dv_pixel_id: pixelId,\n    dv_anonymous_id: anonymousId,\n  });\n\n  // Fire server-side tracking if endpoint configured\n  if (trackingEndpoint && anonymousId) {\n    trackEvent(trackingEndpoint, {\n      event: \"page_view\",\n      anonymousId,\n      builderSlug: pixelId,\n      timestamp: new Date().toISOString(),\n    });\n  }\n}\n\nexport function trackPlanView(pixelId: string, plan: FloorPlan): void {\n  const data = planData(plan);\n\n  fbq(\"track\", \"ViewContent\", {\n    ...data,\n    value: 0,\n    currency: \"USD\",\n  });\n\n  pushDataLayer(\"dv_plan_view\", {\n    dv_pixel_id: pixelId,\n    ...data,\n  });\n}\n\nexport function trackAIInteraction(\n  pixelId: string,\n  type: \"style_swap\" | \"floor_plan_edit\",\n  planId: string\n): void {\n  fbq(\"trackCustom\", \"DesignVaultInteraction\", {\n    interaction_type: type,\n    plan_id: planId,\n  });\n\n  pushDataLayer(\"dv_ai_interaction\", {\n    dv_pixel_id: pixelId,\n    interaction_type: type,\n    plan_id: planId,\n  });\n}\n\nexport function trackLeadCapture(\n  pixelId: string,\n  plan: FloorPlan,\n  value?: number\n): void {\n  const data = planData(plan);\n\n  fbq(\"track\", \"Lead\", {\n    ...data,\n    value: value ?? 0,\n    currency: \"USD\",\n  });\n\n  pushDataLayer(\"dv_lead_capture\", {\n    dv_pixel_id: pixelId,\n    ...data,\n    value: value ?? 0,\n  });\n}\n\n/** @deprecated Use trackPageView/trackLeadCapture/trackAIInteraction instead */\nexport function fireMetaPixelEvent(\n  pixelId: string,\n  eventName: string,\n  params?: Record<string, unknown>\n): void {\n  fbq(\"track\", eventName, { ...params, pixel_id: pixelId });\n  pushDataLayer(`dv_${eventName.toLowerCase()}`, {\n    dv_pixel_id: pixelId,\n    ...params,\n  });\n}\n\n//  Session Tracking \n\nconst ANON_ID_KEY = \"dv-anonymous-id\";\n\nexport function generateAnonymousId(): string {\n  if (typeof window === \"undefined\") return crypto.randomUUID();\n\n  try {\n    const existing = localStorage.getItem(ANON_ID_KEY);\n    if (existing) return existing;\n\n    const id = crypto.randomUUID();\n    localStorage.setItem(ANON_ID_KEY, id);\n    return id;\n  } catch {\n    // localStorage unavailable (incognito, storage full, etc.)\n    return crypto.randomUUID();\n  }\n}\n\nexport function getSessionDuration(startTime: number): number {\n  return Math.round((Date.now() - startTime) / 1000);\n}\n\nexport function trackEvent(\n  endpoint: string,\n  eventData: Record<string, unknown>\n): void {\n  if (!endpoint) return;\n\n  // Fire-and-forget  don't block the UI\n  fetch(endpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      ...eventData,\n      sentAt: new Date().toISOString(),\n    }),\n  }).catch(() => {\n    // Silently fail  tracking should never break the app\n  });\n}\n\n//  Scheduler URL \n\nfunction getCookie(name: string): string | null {\n  if (typeof document === \"undefined\") return null;\n  const match = document.cookie.match(new RegExp(`(?:^|; )${name}=([^;]*)`));\n  return match ? decodeURIComponent(match[1]) : null;\n}\n\nexport function getSchedulerUrl(baseUrl: string): string {\n  if (typeof window === \"undefined\") return baseUrl;\n\n  const url = new URL(baseUrl);\n  const params = new URLSearchParams(window.location.search);\n\n  // fbclid from URL params or localStorage\n  const fbclid = params.get(\"fbclid\") || (() => {\n    try { return localStorage.getItem(\"fbclid\"); } catch { return null; }\n  })();\n  if (fbclid) url.searchParams.set(\"fbclid\", fbclid);\n\n  // _fbp and _fbc from cookies\n  const fbp = getCookie(\"_fbp\");\n  if (fbp) url.searchParams.set(\"fbp\", fbp);\n\n  const fbc = getCookie(\"_fbc\");\n  if (fbc) url.searchParams.set(\"fbc\", fbc);\n\n  return url.toString();\n}\n\n//  Performance Tracking \n\ninterface LatencyEntry {\n  type: \"style_swap\" | \"floor_plan_edit\" | \"enhance_prompt\";\n  durationMs: number;\n  timestamp: string;\n}\n\nconst latencyLog: LatencyEntry[] = [];\n\nexport function trackAILatency(\n  type: LatencyEntry[\"type\"],\n  startTime: number,\n  endTime: number\n): void {\n  const entry: LatencyEntry = {\n    type,\n    durationMs: endTime - startTime,\n    timestamp: new Date().toISOString(),\n  };\n\n  latencyLog.push(entry);\n\n  // Keep only last 50 entries in memory\n  if (latencyLog.length > 50) {\n    latencyLog.shift();\n  }\n\n  pushDataLayer(\"dv_ai_latency\", {\n    ai_type: entry.type,\n    duration_ms: entry.durationMs,\n  });\n}\n\n/** Returns the collected latency entries (for debugging / analytics) */\nexport function getLatencyLog(): readonly LatencyEntry[] {\n  return latencyLog;\n}\n","import { useCallback, useState } from \"react\";\nimport { useDesignVaultContext } from \"./useDesignVault\";\nimport { fireMetaPixelEvent } from \"../utils/tracking\";\nimport type { LeadCaptureData } from \"../types\";\n\nfunction getCookie(name: string): string | null {\n  if (typeof document === \"undefined\") return null;\n  const match = document.cookie.match(new RegExp(`(?:^|; )${name}=([^;]*)`));\n  return match ? decodeURIComponent(match[1]) : null;\n}\n\nfunction getFbTracking() {\n  if (typeof window === \"undefined\") return {};\n  const params = new URLSearchParams(window.location.search);\n  const fbclid = params.get(\"fbclid\") || (() => {\n    try { return localStorage.getItem(\"fbclid\"); } catch { return null; }\n  })();\n  const fbp = getCookie(\"_fbp\");\n  const fbc = getCookie(\"_fbc\");\n  return {\n    ...(fbclid && { fbclid }),\n    ...(fbp && { fbp }),\n    ...(fbc && { fbc }),\n    client_user_agent: navigator.userAgent,\n  };\n}\n\nconst FAVORITES_KEY = \"dv-favorites\";\n\nfunction readFavoritesFromStorage(): string[] {\n  if (typeof window === \"undefined\") return [];\n  try {\n    const stored = localStorage.getItem(FAVORITES_KEY);\n    return stored ? JSON.parse(stored) : [];\n  } catch {\n    return [];\n  }\n}\n\nexport function useLeadCapture() {\n  const {\n    api,\n    config,\n    anonymousId,\n    sessionStartTime,\n    sessionId,\n    modifications,\n    plansViewed,\n    currentPlan,\n    stylePref,\n    setCaptured,\n  } = useDesignVaultContext();\n\n  const [isOpen, setIsOpen] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitted, setSubmitted] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const openCapture = useCallback(() => setIsOpen(true), []);\n  const closeCapture = useCallback(() => setIsOpen(false), []);\n\n  const submitCapture = useCallback(\n    async (formData: {\n      firstName: string;\n      lastName: string;\n      email: string;\n      phone: string;\n    }) => {\n      setIsSubmitting(true);\n      setError(null);\n\n      const sessionDuration = Math.floor(\n        (Date.now() - sessionStartTime) / 1000\n      );\n\n      const data: LeadCaptureData = {\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        email: formData.email,\n        phone: formData.phone,\n        planId: currentPlan?.id ?? \"\",\n        planTitle: currentPlan?.title ?? \"\",\n        planSpecs: {\n          beds: currentPlan?.beds ?? 0,\n          baths: currentPlan?.baths ?? 0,\n          area: currentPlan?.area ?? 0,\n        },\n        modifications,\n        favorites: readFavoritesFromStorage(),\n        stylePref,\n        sessionDuration,\n        plansViewed: plansViewed.length,\n        ...getFbTracking(),\n      };\n\n      try {\n        await api.saveDesign(\n          data,\n          sessionId ?? anonymousId,\n          config.builderSlug\n        );\n\n        setSubmitted(true);\n        setCaptured(true);\n        setIsOpen(false);\n\n        // Fire Meta pixel Lead event if configured\n        if (config.metaPixelId) {\n          fireMetaPixelEvent(config.metaPixelId, \"Lead\", {\n            content_name: currentPlan?.title,\n            content_ids: [currentPlan?.id],\n            content_category: currentPlan?.category,\n            value: currentPlan?.area,\n          });\n        }\n      } catch (err) {\n        const msg = err instanceof Error ? err.message : String(err);\n        setError(msg);\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    [\n      api,\n      config.builderSlug,\n      config.metaPixelId,\n      anonymousId,\n      sessionStartTime,\n      sessionId,\n      modifications,\n      plansViewed.length,\n      currentPlan,\n      stylePref,\n      setCaptured,\n    ]\n  );\n\n  return {\n    isOpen,\n    openCapture,\n    closeCapture,\n    submitCapture,\n    isSubmitting,\n    submitted,\n    error,\n  };\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { X, Send, CheckCircle, Loader2, Sparkles } from \"lucide-react\";\nimport { useLeadCapture } from \"../hooks/useLeadCapture\";\nimport type { LeadCaptureModalProps, Modification } from \"../types\";\n\n//  Skip counter (localStorage) \n\nconst SKIP_KEY = \"dv-lead-skip-count\";\n\nfunction getSkipCount(): number {\n  if (typeof window === \"undefined\") return 0;\n  try {\n    return parseInt(localStorage.getItem(SKIP_KEY) ?? \"0\", 10) || 0;\n  } catch {\n    return 0;\n  }\n}\n\nfunction incrementSkipCount(): number {\n  const next = getSkipCount() + 1;\n  try {\n    localStorage.setItem(SKIP_KEY, String(next));\n  } catch {\n    /* storage may be unavailable */\n  }\n  return next;\n}\n\n//  Modification summary \n\nfunction summarizeMod(mod: Modification): string {\n  if (mod.type === \"style_swap\" && mod.stylePreset) {\n    const label = mod.stylePreset\n      .replace(/_/g, \" \")\n      .replace(/\\b\\w/g, (c) => c.toUpperCase());\n    return `Style swap to ${label}`;\n  }\n  if (mod.type === \"wishlist_item\" && mod.prompt) {\n    return mod.prompt.length > 50\n      ? `Wishlist: ${mod.prompt.slice(0, 47)}\\u2026`\n      : `Wishlist: ${mod.prompt}`;\n  }\n  if (mod.type === \"floor_plan_edit\" && mod.prompt) {\n    return mod.prompt.length > 50\n      ? mod.prompt.slice(0, 50) + \"\\u2026\"\n      : mod.prompt;\n  }\n  return mod.type === \"style_swap\" ? \"Style customization\" : \"Floor plan edit\";\n}\n\n//  Validation \n\ninterface FieldErrors {\n  firstName?: string;\n  lastName?: string;\n  email?: string;\n  phone?: string;\n}\n\nconst EMAIL_RE = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\nfunction validateFields(data: {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone: string;\n}): FieldErrors {\n  const errors: FieldErrors = {};\n\n  if (!data.firstName.trim()) errors.firstName = \"First name is required\";\n  if (!data.lastName.trim()) errors.lastName = \"Last name is required\";\n\n  if (!data.email.trim()) {\n    errors.email = \"Email is required\";\n  } else if (!EMAIL_RE.test(data.email)) {\n    errors.email = \"Please enter a valid email address\";\n  }\n\n  const digits = data.phone.replace(/\\D/g, \"\");\n  if (!digits) {\n    errors.phone = \"Phone number is required\";\n  } else if (digits.length < 10) {\n    errors.phone = \"Please enter a valid phone number (10+ digits)\";\n  }\n\n  return errors;\n}\n\n//  Component \n\nexport const LeadCaptureModal: React.FC<LeadCaptureModalProps> = ({\n  isOpen,\n  onClose,\n  onSubmit,\n  plan,\n  modifications,\n  config,\n}) => {\n  const {\n    submitCapture,\n    isSubmitting,\n    submitted,\n    error: hookError,\n  } = useLeadCapture();\n\n  // Form state\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [errors, setErrors] = useState<FieldErrors>({});\n  const [touched, setTouched] = useState<Set<string>>(new Set());\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [skipCount, setSkipCount] = useState(getSkipCount);\n\n  // Reset form state when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setFirstName(\"\");\n      setLastName(\"\");\n      setEmail(\"\");\n      setPhone(\"\");\n      setErrors({});\n      setTouched(new Set());\n      setShowSuccess(false);\n      setSkipCount(getSkipCount());\n    }\n  }, [isOpen]);\n\n  // Handle successful submission  show confirmation, then close\n  useEffect(() => {\n    if (submitted && isOpen && !showSuccess) {\n      setShowSuccess(true);\n      onSubmit?.();\n      const timer = setTimeout(onClose, 2000);\n      return () => clearTimeout(timer);\n    }\n  }, [submitted, isOpen, showSuccess, onSubmit, onClose]);\n\n  //  Field-level blur validation \n  const handleBlur = useCallback(\n    (field: keyof FieldErrors) => {\n      setTouched((prev) => {\n        const next = new Set(prev);\n        next.add(field);\n        return next;\n      });\n\n      // Re-validate on blur so error clears when fixed\n      setErrors(validateFields({ firstName, lastName, email, phone }));\n    },\n    [firstName, lastName, email, phone]\n  );\n\n  //  Submit \n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    const data = { firstName, lastName, email, phone };\n    const fieldErrors = validateFields(data);\n    setErrors(fieldErrors);\n    setTouched(new Set([\"firstName\", \"lastName\", \"email\", \"phone\"]));\n\n    if (Object.keys(fieldErrors).length > 0) return;\n\n    await submitCapture({\n      ...data,\n      phone: phone.replace(/\\D/g, \"\"),\n    });\n  };\n\n  //  Skip \n  const handleSkip = useCallback(() => {\n    incrementSkipCount();\n    setSkipCount((c) => c + 1);\n    onClose();\n  }, [onClose]);\n\n  //  Backdrop close (blocked while submitting) \n  const handleBackdropClick = useCallback(() => {\n    if (!isSubmitting) onClose();\n  }, [isSubmitting, onClose]);\n\n  // After 2 skips, hide the \"Skip for now\" link\n  const canSkip = skipCount < 2;\n\n  // Builder display name from slug\n  const builderName = config.builderSlug\n    .replace(/[-_]/g, \" \")\n    .replace(/\\b\\w/g, (c) => c.toUpperCase());\n\n  //  Inline error helper \n  const fieldError = (field: keyof FieldErrors) =>\n    touched.has(field) && errors[field] ? errors[field] : null;\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"dv-lead-overlay\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.2 }}\n          onClick={handleBackdropClick}\n        >\n          <motion.div\n            className=\"dv-lead-modal\"\n            initial={{ scale: 0.95, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            exit={{ scale: 0.95, opacity: 0 }}\n            transition={{ duration: 0.25, ease: \"easeOut\" }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            {/* Close button */}\n            <button\n              className=\"dv-lead-modal__close\"\n              onClick={onClose}\n              aria-label=\"Close\"\n              disabled={isSubmitting}\n            >\n              <X size={20} />\n            </button>\n\n            {showSuccess ? (\n              /*  Success confirmation  */\n              <div className=\"dv-lead-modal__success\">\n                <CheckCircle size={48} className=\"dv-lead-modal__success-icon\" />\n                <h2 className=\"dv-lead-modal__title\">Saved!</h2>\n                <p className=\"dv-lead-modal__subtitle\">\n                  Check your email for the full details.\n                </p>\n              </div>\n            ) : (\n              /*  Form  */\n              <>\n                {/* Header */}\n                <div className=\"dv-lead-modal__header\">\n                  <Sparkles size={24} className=\"dv-lead-modal__header-icon\" />\n                  <h2 className=\"dv-lead-modal__title\">\n                    Save Your Custom Design\n                  </h2>\n                  <p className=\"dv-lead-modal__subtitle\">\n                    Enter your contact info to unlock more AI customizations\n                    and receive the full details for{\" \"}\n                    <strong>{plan.title}</strong>\n                  </p>\n                </div>\n\n                {/* Modifications preview */}\n                {modifications.length > 0 && (\n                  <div className=\"dv-lead-modal__mods\">\n                    <span className=\"dv-lead-modal__mods-label\">\n                      Your customizations:\n                    </span>\n                    <div className=\"dv-lead-modal__mods-list\">\n                      {modifications.map((mod, i) => (\n                        <span key={i} className=\"dv-lead-modal__mod-tag\">\n                          {summarizeMod(mod)}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* API error */}\n                {hookError && (\n                  <div className=\"dv-lead-modal__api-error\">{hookError}</div>\n                )}\n\n                <form\n                  className=\"dv-lead-modal__form\"\n                  onSubmit={handleSubmit}\n                  noValidate\n                >\n                  {/* First + Last name */}\n                  <div className=\"dv-lead-modal__row\">\n                    <div className=\"dv-lead-modal__field\">\n                      <input\n                        className={`dv-lead-modal__input ${\n                          fieldError(\"firstName\")\n                            ? \"dv-lead-modal__input--error\"\n                            : \"\"\n                        }`}\n                        type=\"text\"\n                        placeholder=\"First Name\"\n                        value={firstName}\n                        onChange={(e) => setFirstName(e.target.value)}\n                        onBlur={() => handleBlur(\"firstName\")}\n                        disabled={isSubmitting}\n                        autoComplete=\"given-name\"\n                      />\n                      {fieldError(\"firstName\") && (\n                        <span className=\"dv-lead-modal__field-error\">\n                          {fieldError(\"firstName\")}\n                        </span>\n                      )}\n                    </div>\n\n                    <div className=\"dv-lead-modal__field\">\n                      <input\n                        className={`dv-lead-modal__input ${\n                          fieldError(\"lastName\")\n                            ? \"dv-lead-modal__input--error\"\n                            : \"\"\n                        }`}\n                        type=\"text\"\n                        placeholder=\"Last Name\"\n                        value={lastName}\n                        onChange={(e) => setLastName(e.target.value)}\n                        onBlur={() => handleBlur(\"lastName\")}\n                        disabled={isSubmitting}\n                        autoComplete=\"family-name\"\n                      />\n                      {fieldError(\"lastName\") && (\n                        <span className=\"dv-lead-modal__field-error\">\n                          {fieldError(\"lastName\")}\n                        </span>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Email */}\n                  <div className=\"dv-lead-modal__field\">\n                    <input\n                      className={`dv-lead-modal__input ${\n                        fieldError(\"email\")\n                          ? \"dv-lead-modal__input--error\"\n                          : \"\"\n                      }`}\n                      type=\"email\"\n                      placeholder=\"Email\"\n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      onBlur={() => handleBlur(\"email\")}\n                      disabled={isSubmitting}\n                      autoComplete=\"email\"\n                    />\n                    {fieldError(\"email\") && (\n                      <span className=\"dv-lead-modal__field-error\">\n                        {fieldError(\"email\")}\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Phone */}\n                  <div className=\"dv-lead-modal__field\">\n                    <input\n                      className={`dv-lead-modal__input ${\n                        fieldError(\"phone\")\n                          ? \"dv-lead-modal__input--error\"\n                          : \"\"\n                      }`}\n                      type=\"tel\"\n                      placeholder=\"Phone\"\n                      value={phone}\n                      onChange={(e) => setPhone(e.target.value)}\n                      onBlur={() => handleBlur(\"phone\")}\n                      disabled={isSubmitting}\n                      autoComplete=\"tel\"\n                    />\n                    {fieldError(\"phone\") && (\n                      <span className=\"dv-lead-modal__field-error\">\n                        {fieldError(\"phone\")}\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Privacy text */}\n                  <p className=\"dv-lead-modal__privacy\">\n                    Your info will be shared with{\" \"}\n                    <strong>{builderName}</strong> to help you build this home.\n                  </p>\n\n                  {/* Submit button */}\n                  <button\n                    className=\"dv-lead-modal__submit\"\n                    type=\"submit\"\n                    disabled={isSubmitting}\n                  >\n                    {isSubmitting ? (\n                      <>\n                        <Loader2\n                          size={18}\n                          className=\"dv-lead-modal__spinner\"\n                        />\n                        Saving...\n                      </>\n                    ) : (\n                      <>\n                        <Send size={16} />\n                        {config.ctaText || \"Save My Design\"}\n                      </>\n                    )}\n                  </button>\n                </form>\n\n                {/* Skip link */}\n                {canSkip && (\n                  <button\n                    className=\"dv-lead-modal__skip\"\n                    onClick={handleSkip}\n                    disabled={isSubmitting}\n                    type=\"button\"\n                  >\n                    Skip for now\n                  </button>\n                )}\n              </>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n","import { useCallback, useState } from \"react\";\nimport { useDesignVaultContext } from \"./useDesignVault\";\nimport { CaptureRequiredError } from \"../api/client\";\nimport type { AIInteractionResult } from \"../types\";\n\nexport function useAIInteractions() {\n  const {\n    api,\n    config,\n    isCaptured,\n    anonymousId,\n    sessionId,\n    currentPlan,\n    addModification,\n  } = useDesignVaultContext();\n\n  const maxFree = config.maxFreeInteractions ?? 1;\n  const hardLimit = maxFree + 3;\n\n  const [isStyleSwapProcessing, setIsStyleSwapProcessing] = useState(false);\n  const [isFloorPlanProcessing, setIsFloorPlanProcessing] = useState(false);\n  const [lastResult, setLastResult] = useState<AIInteractionResult | null>(\n    null\n  );\n  const [interactionCount, setInteractionCount] = useState(0);\n  const [error, setError] = useState<string | null>(null);\n  const [hitHardLimit, setHitHardLimit] = useState(false);\n  const [serverNeedsCapture, setServerNeedsCapture] = useState(false);\n\n  const needsCapture =\n    (interactionCount >= maxFree && !isCaptured) || (serverNeedsCapture && !isCaptured);\n\n  const effectiveSessionId = sessionId ?? anonymousId;\n\n  const handleStyleSwap = useCallback(\n    async (\n      planId: string,\n      preset: string,\n      imageType?: \"exterior\" | \"interior\",\n      imageUrl?: string\n    ): Promise<AIInteractionResult | null> => {\n      if (interactionCount >= hardLimit) {\n        setHitHardLimit(true);\n        return null;\n      }\n\n      setIsStyleSwapProcessing(true);\n      setError(null);\n\n      try {\n        const result = await api.styleSwap(\n          planId,\n          preset,\n          effectiveSessionId,\n          imageType,\n          imageUrl\n        );\n        setLastResult(result);\n        setServerNeedsCapture(false);\n        setInteractionCount((c) => c + 1);\n\n        if (result.success && result.resultUrl) {\n          addModification({\n            type: \"style_swap\",\n            prompt: null,\n            stylePreset: preset,\n            resultUrl: result.resultUrl,\n            originalUrl: currentPlan?.image_url ?? \"\",\n            timestamp: new Date().toISOString(),\n          });\n        }\n\n        return result;\n      } catch (err) {\n        if (err instanceof CaptureRequiredError) {\n          if (isCaptured) {\n            setError(\"Something went wrong syncing your saved design. Please try again.\");\n          } else {\n            setServerNeedsCapture(true);\n          }\n          return null;\n        }\n        const msg = err instanceof Error ? err.message : String(err);\n        setError(msg);\n        return null;\n      } finally {\n        setIsStyleSwapProcessing(false);\n      }\n    },\n    [\n      api,\n      effectiveSessionId,\n      isCaptured,\n      interactionCount,\n      hardLimit,\n      addModification,\n      currentPlan?.image_url,\n    ]\n  );\n\n  const handleFloorPlanEdit = useCallback(\n    async (\n      planId: string,\n      prompt: string,\n      currentUrl?: string\n    ): Promise<AIInteractionResult | null> => {\n      if (interactionCount >= hardLimit) {\n        setHitHardLimit(true);\n        return null;\n      }\n\n      setIsFloorPlanProcessing(true);\n      setError(null);\n\n      try {\n        const result = await api.floorPlanEdit(\n          planId,\n          prompt,\n          effectiveSessionId,\n          currentUrl\n        );\n        setLastResult(result);\n        setServerNeedsCapture(false);\n        setInteractionCount((c) => c + 1);\n\n        if (result.success && result.resultUrl) {\n          addModification({\n            type: \"floor_plan_edit\",\n            prompt,\n            stylePreset: null,\n            resultUrl: result.resultUrl,\n            originalUrl: currentUrl ?? currentPlan?.floor_plan_url ?? \"\",\n            timestamp: new Date().toISOString(),\n          });\n        }\n\n        return result;\n      } catch (err) {\n        if (err instanceof CaptureRequiredError) {\n          if (isCaptured) {\n            setError(\"Something went wrong syncing your saved design. Please try again.\");\n          } else {\n            setServerNeedsCapture(true);\n          }\n          return null;\n        }\n        const msg = err instanceof Error ? err.message : String(err);\n        setError(msg);\n        return null;\n      } finally {\n        setIsFloorPlanProcessing(false);\n      }\n    },\n    [\n      api,\n      effectiveSessionId,\n      isCaptured,\n      interactionCount,\n      hardLimit,\n      addModification,\n      currentPlan?.floor_plan_url,\n    ]\n  );\n\n  const handleEnhancePrompt = useCallback(\n    async (\n      prompt: string,\n      imageUrl: string\n    ): Promise<string | null> => {\n      setError(null);\n\n      try {\n        const { enhancedPrompt } = await api.enhancePrompt(prompt, imageUrl);\n        return enhancedPrompt;\n      } catch (err) {\n        const msg = err instanceof Error ? err.message : String(err);\n        setError(msg);\n        return null;\n      }\n    },\n    [api]\n  );\n\n  return {\n    handleStyleSwap,\n    handleFloorPlanEdit,\n    handleEnhancePrompt,\n    isStyleSwapProcessing,\n    isFloorPlanProcessing,\n    lastResult,\n    needsCapture,\n    hitHardLimit,\n    interactionCount,\n    error,\n  };\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { Sparkles, Save, Lock, CalendarCheck } from \"lucide-react\";\nimport { StyleSwapButtons } from \"./StyleSwapButtons\";\nimport { FloorPlanEditor } from \"./FloorPlanEditor\";\nimport { LeadCaptureModal } from \"./LeadCaptureModal\";\nimport { useAIInteractions } from \"../hooks/useAIInteractions\";\nimport { useDesignVaultContext } from \"../hooks/useDesignVault\";\nimport { getSchedulerUrl } from \"../utils/tracking\";\nimport type { AIToolsPanelProps } from \"../types\";\n\nexport const AIToolsPanel: React.FC<AIToolsPanelProps> = ({\n  plan,\n  config,\n  heroUrl,\n  originalHeroUrl,\n  imageType,\n  floorPlanUrl,\n  originalFloorPlanUrl,\n  hasFloorPlanResult,\n  showOriginalFloorPlan,\n  onToggleFloorPlanOriginal,\n  onResult,\n  onProcessingChange,\n}) => {\n  const {\n    handleStyleSwap,\n    handleFloorPlanEdit,\n    isStyleSwapProcessing,\n    isFloorPlanProcessing,\n    needsCapture,\n    hitHardLimit,\n    error: aiError,\n  } = useAIInteractions();\n\n  const { modifications, isCaptured, addModification } =\n    useDesignVaultContext();\n\n  const [modalOpen, setModalOpen] = useState(false);\n  const [activePreset, setActivePreset] = useState<string | null>(\n    plan.style ?? null\n  );\n  const [wishlistItems, setWishlistItems] = useState<string[]>([]);\n\n  // Reset wishlist when plan changes\n  useEffect(() => {\n    setWishlistItems([]);\n  }, [plan.id]);\n\n  // Sync style swap processing to PlanDetail for hero shimmer\n  useEffect(() => {\n    onProcessingChange(isStyleSwapProcessing);\n  }, [isStyleSwapProcessing, onProcessingChange]);\n\n\n  //  Style Swap \n\n  const onSwap = useCallback(\n    async (presetId: string) => {\n      if (needsCapture) {\n        setModalOpen(true);\n        return;\n      }\n\n      setActivePreset(presetId);\n      const result = await handleStyleSwap(plan.id, presetId, imageType, originalHeroUrl);\n\n      if (result?.success && result.resultUrl) {\n        onResult({\n          newUrl: result.resultUrl,\n          originalUrl: originalHeroUrl,\n          type: \"style_swap\",\n        });\n      }\n    },\n    [needsCapture, handleStyleSwap, plan.id, imageType, originalHeroUrl, onResult]\n  );\n\n  //  Wishlist \n\n  const onWishlistAdd = useCallback(\n    (text: string) => {\n      setWishlistItems((prev) => [...prev, text]);\n\n      // Record as a modification so it's included in lead data\n      addModification({\n        type: \"wishlist_item\",\n        prompt: text,\n        stylePreset: null,\n        resultUrl: \"\",\n        originalUrl: \"\",\n        timestamp: new Date().toISOString(),\n      });\n    },\n    [addModification]\n  );\n\n  const onWishlistRemove = useCallback((index: number) => {\n    setWishlistItems((prev) => prev.filter((_, i) => i !== index));\n  }, []);\n\n  const onPreviewAI = useCallback(async () => {\n    if (needsCapture) {\n      setModalOpen(true);\n      return;\n    }\n\n    // Concatenate all wishlist items into one prompt\n    const prompt =\n      \"Make these changes: \" +\n      wishlistItems.map((item, i) => `${i + 1}) ${item}`).join(\" \");\n\n    const result = await handleFloorPlanEdit(\n      plan.id,\n      prompt,\n      plan.floor_plan_url ?? undefined\n    );\n\n    if (result?.success && result.resultUrl) {\n      onResult({\n        newUrl: result.resultUrl,\n        originalUrl: plan.floor_plan_url ?? plan.image_url,\n        type: \"floor_plan_edit\",\n      });\n    }\n  }, [\n    needsCapture,\n    wishlistItems,\n    handleFloorPlanEdit,\n    plan.id,\n    plan.floor_plan_url,\n    plan.image_url,\n    onResult,\n  ]);\n\n  //  Modal \n\n  const openModal = useCallback(() => setModalOpen(true), []);\n  const closeModal = useCallback(() => setModalOpen(false), []);\n\n  return (\n    <div className=\"dv-ai-tools\">\n      {/* Header */}\n      <div className=\"dv-ai-tools__header\">\n        <Sparkles size={20} />\n        <h3 className=\"dv-ai-tools__title\">AI Design Tools</h3>\n      </div>\n\n      {/* Gate banner  shown when user needs to save to continue */}\n      {(needsCapture || (aiError && !isCaptured)) && !hitHardLimit && (\n        <div className=\"dv-ai-tools__gate\">\n          <Lock size={18} className=\"dv-ai-tools__gate-icon\" />\n          <p className=\"dv-ai-tools__gate-title\">\n            You've used your free design preview\n          </p>\n          <p className=\"dv-ai-tools__gate-sub\">\n            Save your design to unlock more AI tools\n          </p>\n          <button\n            className=\"dv-ai-tools__gate-btn\"\n            onClick={openModal}\n          >\n            <Save size={16} />\n            {config.ctaText || \"Save My Design\"}\n          </button>\n        </div>\n      )}\n\n      {/* Hard limit  schedule consultation CTA */}\n      {hitHardLimit && (\n        <div className=\"dv-ai-tools__gate\">\n          <CalendarCheck size={18} className=\"dv-ai-tools__gate-icon\" />\n          <p className=\"dv-ai-tools__gate-title\">\n            You've explored all your free customizations!\n          </p>\n          <p className=\"dv-ai-tools__gate-sub\">\n            Ready to make this plan yours? Schedule a free consultation and\n            we'll create your full custom plan set.\n          </p>\n          <button\n            className=\"dv-ai-tools__gate-btn\"\n            onClick={() => {\n              const url = getSchedulerUrl(\n                config.schedulerUrl ?? \"https://crm.empowerbuilding.ai/book/barnhaus-consultation\"\n              );\n              window.open(url, \"_blank\", \"noopener\");\n            }}\n          >\n            <CalendarCheck size={16} />\n            Schedule My Consultation\n          </button>\n        </div>\n      )}\n\n      {/* Error message (only for non-gate/non-limit errors, e.g. network/server issues) */}\n      {aiError && isCaptured && !hitHardLimit && (\n        <div className=\"dv-ai-tools__error\">{aiError}</div>\n      )}\n\n      {/*  CHANGE EXTERIOR STYLE section  */}\n      {config.enableStyleSwap !== false && (\n        <div className=\"dv-ai-tools__section\">\n          <div className=\"dv-ai-tools__section-header\">\n            <img\n              src={heroUrl}\n              alt=\"Exterior preview\"\n              className=\"dv-ai-tools__section-thumb\"\n              width={48}\n              height={36}\n            />\n            <span className=\"dv-ai-tools__section-label\">\n              {imageType === \"interior\" ? \"Change Interior Style\" : \"Change Exterior Style\"}\n            </span>\n          </div>\n          <StyleSwapButtons\n            planId={plan.id}\n            currentStyle={plan.style}\n            onSwap={onSwap}\n            isProcessing={isStyleSwapProcessing}\n            activePreset={activePreset}\n          />\n        </div>\n      )}\n\n      <div className=\"dv-ai-tools__divider\" />\n\n      {/*  CUSTOMIZE FLOOR PLAN section  */}\n      {config.enableFloorPlanEdit !== false && (\n        <div className=\"dv-ai-tools__section\">\n          <div className=\"dv-ai-tools__section-header\">\n            <span className=\"dv-ai-tools__section-label\">Customize Floor Plan</span>\n          </div>\n          <FloorPlanEditor\n            planId={plan.id}\n            floorPlanUrl={floorPlanUrl}\n            originalFloorPlanUrl={originalFloorPlanUrl}\n            hasFloorPlanResult={hasFloorPlanResult}\n            showOriginalFloorPlan={showOriginalFloorPlan}\n            onToggleFloorPlanOriginal={onToggleFloorPlanOriginal}\n            wishlistItems={wishlistItems}\n            onWishlistAdd={onWishlistAdd}\n            onWishlistRemove={onWishlistRemove}\n            onPreviewAI={onPreviewAI}\n            isProcessing={isFloorPlanProcessing}\n          />\n        </div>\n      )}\n\n      <div className=\"dv-ai-tools__divider\" />\n\n      {/* Save Design button */}\n      <button\n        className=\"dv-ai-tools__save-btn\"\n        onClick={openModal}\n        disabled={isCaptured}\n      >\n        <Save size={16} />\n        {isCaptured ? \"Design Saved\" : \"Save This Design\"}\n      </button>\n\n      {/* Callout */}\n      {!hitHardLimit && (\n        <p className=\"dv-ai-tools__callout\">\n          First customization is free. Save your design to unlock more.\n        </p>\n      )}\n\n      {/* Lead Capture Modal */}\n      <LeadCaptureModal\n        isOpen={modalOpen}\n        onClose={closeModal}\n        plan={plan}\n        modifications={modifications}\n        config={config}\n      />\n    </div>\n  );\n};\n","import React, { useMemo } from \"react\";\nimport { Home, Bath, Square } from \"lucide-react\";\nimport type { FloorPlan, SimilarPlansProps } from \"../types\";\n\nfunction scoreSimilarity(a: FloorPlan, b: FloorPlan): number {\n  let score = 0;\n  if (a.style && a.style === b.style) score += 3;\n  if (a.category && a.category === b.category) score += 3;\n  if (Math.abs(a.beds - b.beds) <= 1) score += 2;\n  if (Math.abs(a.area - b.area) <= 500) score += 2;\n  if (a.price_tier && a.price_tier === b.price_tier) score += 1;\n  return score;\n}\n\nexport const SimilarPlans: React.FC<SimilarPlansProps> = ({\n  currentPlan,\n  allPlans,\n  onPlanSelect,\n}) => {\n  const similar = useMemo(() => {\n    return allPlans\n      .filter((p) => p.id !== currentPlan.id)\n      .map((p) => ({ plan: p, score: scoreSimilarity(currentPlan, p) }))\n      .sort((a, b) => b.score - a.score)\n      .slice(0, 3)\n      .filter((s) => s.score > 0)\n      .map((s) => s.plan);\n  }, [currentPlan, allPlans]);\n\n  if (similar.length === 0) return null;\n\n  return (\n    <div className=\"dv-similar-plans\">\n      <h3 className=\"dv-similar-plans__title\">Similar Plans</h3>\n      <div className=\"dv-similar-plans__grid\">\n        {similar.map((plan) => (\n          <button\n            key={plan.id}\n            className=\"dv-similar-plans__card\"\n            onClick={() => onPlanSelect(plan)}\n          >\n            <img\n              src={plan.image_url}\n              alt={plan.title}\n              className=\"dv-similar-plans__img\"\n              loading=\"lazy\"\n            />\n            <div className=\"dv-similar-plans__info\">\n              <span className=\"dv-similar-plans__name\">{plan.title}</span>\n              <span className=\"dv-similar-plans__specs\">\n                <Home size={12} /> {plan.beds}\n                <Bath size={12} /> {plan.baths}\n                <Square size={12} /> {plan.area.toLocaleString()}\n              </span>\n            </div>\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n};\n","import { useCallback, useMemo } from \"react\";\nimport { useDesignVaultContext } from \"./useDesignVault\";\nimport type { DesignSession, FloorPlan, Modification } from \"../types\";\n\nexport function useSession() {\n  const {\n    api,\n    config,\n    anonymousId,\n    sessionStartTime,\n    isCaptured,\n    sessionId,\n    setSessionId,\n    modifications,\n    addModification: ctxAddModification,\n    plansViewed,\n    addPlanViewed,\n    currentPlan,\n    setCurrentPlan: ctxSetCurrentPlan,\n    stylePref,\n  } = useDesignVaultContext();\n\n  // Assemble a DesignSession from context state\n  const session = useMemo<DesignSession | null>(() => {\n    if (!sessionId) return null;\n    return {\n      id: sessionId,\n      anonymousId,\n      planId: currentPlan?.id ?? \"\",\n      builderSlug: config.builderSlug,\n      modifications,\n      stylePref,\n      capturedAt: isCaptured ? new Date().toISOString() : null,\n      contactId: null,\n    };\n  }, [\n    sessionId,\n    anonymousId,\n    currentPlan?.id,\n    config.builderSlug,\n    modifications,\n    stylePref,\n    isCaptured,\n  ]);\n\n  const addModification = useCallback(\n    (mod: Modification) => {\n      ctxAddModification(mod);\n    },\n    [ctxAddModification]\n  );\n\n  // Select a plan: store it, track the view, call trackClick, create session\n  const setCurrentPlan = useCallback(\n    async (plan: FloorPlan) => {\n      ctxSetCurrentPlan(plan);\n      addPlanViewed(plan.id);\n\n      // Track click (fire-and-forget)\n      api.trackClick(plan.id).catch(() => {});\n\n      // Create session on first plan selection\n      if (!sessionId) {\n        try {\n          const { sessionId: newId } = await api.createSession(\n            plan.id,\n            config.builderSlug,\n            anonymousId\n          );\n          setSessionId(newId);\n        } catch {\n          // Non-critical  interactions will fall back to anonymousId\n        }\n      }\n    },\n    [\n      api,\n      config.builderSlug,\n      anonymousId,\n      sessionId,\n      setSessionId,\n      ctxSetCurrentPlan,\n      addPlanViewed,\n    ]\n  );\n\n  const getSessionDuration = useCallback(() => {\n    return Math.floor((Date.now() - sessionStartTime) / 1000);\n  }, [sessionStartTime]);\n\n  return {\n    session,\n    addModification,\n    setCurrentPlan,\n    plansViewed,\n    getSessionDuration,\n  };\n}\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { AnimatePresence, motion, type PanInfo } from \"framer-motion\";\nimport { X, Home, Bath, Square, Check, ArrowRight } from \"lucide-react\";\nimport { AIToolsPanel } from \"./AIToolsPanel\";\nimport { ImageLightbox } from \"./ImageLightbox\";\nimport { SimilarPlans } from \"./SimilarPlans\";\nimport { useSession } from \"../hooks/useSession\";\nimport { getSchedulerUrl } from \"../utils/tracking\";\nimport type { PlanDetailProps } from \"../types\";\n\nconst heroSlideVariants = {\n  enter: (dir: number) => ({ x: dir > 0 ? 300 : -300, opacity: 0 }),\n  center: { x: 0, opacity: 1 },\n  exit: (dir: number) => ({ x: dir > 0 ? -300 : 300, opacity: 0 }),\n};\n\nexport const PlanDetail: React.FC<PlanDetailProps> = ({\n  plan,\n  isOpen,\n  onClose,\n  config,\n  allPlans,\n  onPlanSwitch,\n}) => {\n  const { setCurrentPlan } = useSession();\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  const [activeIndex, setActiveIndex] = useState(0);\n  const [aiResults, setAiResults] = useState<Record<string, string>>({});\n  const [showOriginal, setShowOriginal] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [lightboxOpen, setLightboxOpen] = useState(false);\n  const [swipeDirection, setSwipeDirection] = useState<1 | -1>(1);\n\n  // Floor plan AI result state (separate from hero/exterior)\n  const [floorPlanUrl, setFloorPlanUrl] = useState(plan.floor_plan_url ?? \"\");\n  const [originalFloorPlanUrl, setOriginalFloorPlanUrl] = useState(plan.floor_plan_url ?? \"\");\n  const [showOriginalFloorPlan, setShowOriginalFloorPlan] = useState(false);\n  const [hasFloorPlanResult, setHasFloorPlanResult] = useState(false);\n\n  // Build thumbnail list\n  const thumbnails = useMemo(() => {\n    const thumbs: { url: string; label: string }[] = [\n      { url: plan.image_url, label: \"Exterior\" },\n    ];\nif (plan.interior_urls) {\n      plan.interior_urls.forEach((url, i) => {\n        thumbs.push({ url, label: `Interior ${i + 1}` });\n      });\n    }\n    return thumbs;\n  }, [plan]);\n\n  // Derived values for the active image\n  const currentOriginalUrl = thumbnails[activeIndex]?.url ?? plan.image_url;\n  const currentAiUrl = aiResults[currentOriginalUrl];\n  const hasAiResult = !!currentAiUrl;\n  const displayUrl = showOriginal ? currentOriginalUrl : (currentAiUrl ?? currentOriginalUrl);\n  const imageType: \"exterior\" | \"interior\" =\n    thumbnails[activeIndex]?.label === \"Exterior\" ? \"exterior\" : \"interior\";\n\n  // Track plan view on open\n  useEffect(() => {\n    if (isOpen) {\n      setCurrentPlan(plan);\n      setActiveIndex(0);\n      setAiResults({});\n      setShowOriginal(false);\n      setSwipeDirection(1);\n      setFloorPlanUrl(plan.floor_plan_url ?? \"\");\n      setOriginalFloorPlanUrl(plan.floor_plan_url ?? \"\");\n      setHasFloorPlanResult(false);\n      setShowOriginalFloorPlan(false);\n      panelRef.current?.scrollTo(0, 0);\n    }\n  }, [isOpen, plan, setCurrentPlan]);\n\n  // Lock body scroll\n  useEffect(() => {\n    if (isOpen) {\n      const prev = document.body.style.overflow;\n      document.body.style.overflow = \"hidden\";\n      return () => {\n        document.body.style.overflow = prev;\n      };\n    }\n  }, [isOpen]);\n\n  // Escape key\n  useEffect(() => {\n    if (!isOpen) return;\n    const handler = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") onClose();\n    };\n    window.addEventListener(\"keydown\", handler);\n    return () => window.removeEventListener(\"keydown\", handler);\n  }, [isOpen, onClose]);\n\n  const handleResult = useCallback(\n    (result: {\n      newUrl: string;\n      originalUrl: string;\n      type: \"style_swap\" | \"floor_plan_edit\";\n    }) => {\n      if (result.type === \"floor_plan_edit\") {\n        setFloorPlanUrl(result.newUrl);\n        setOriginalFloorPlanUrl(result.originalUrl);\n        setHasFloorPlanResult(true);\n        setShowOriginalFloorPlan(false);\n      } else {\n        setAiResults((prev) => ({\n          ...prev,\n          [result.originalUrl]: result.newUrl,\n        }));\n        setShowOriginal(false);\n      }\n    },\n    []\n  );\n\n  const handlePlanSelect = useCallback(\n    (newPlan: typeof plan) => {\n      if (onPlanSwitch) {\n        onPlanSwitch(newPlan);\n      } else {\n        setCurrentPlan(newPlan);\n        setActiveIndex(0);\n        setAiResults({});\n        setShowOriginal(false);\n        setFloorPlanUrl(newPlan.floor_plan_url ?? \"\");\n        setOriginalFloorPlanUrl(newPlan.floor_plan_url ?? \"\");\n        setHasFloorPlanResult(false);\n        setShowOriginalFloorPlan(false);\n      }\n    },\n    [onPlanSwitch, setCurrentPlan]\n  );\n\n  const handleSchedulerClick = useCallback(() => {\n    if (!config.schedulerUrl) return;\n    window.open(getSchedulerUrl(config.schedulerUrl), \"_blank\", \"noopener\");\n  }, [config.schedulerUrl]);\n\n  const handleHeroSwipe = useCallback(\n    (_event: MouseEvent | TouchEvent | PointerEvent, info: PanInfo) => {\n      const { offset, velocity } = info;\n      const swipedLeft = offset.x < -50 || velocity.x < -300;\n      const swipedRight = offset.x > 50 || velocity.x > 300;\n      if (swipedLeft && activeIndex < thumbnails.length - 1) {\n        setSwipeDirection(1);\n        setActiveIndex((prev) => prev + 1);\n        setShowOriginal(false);\n      } else if (swipedRight && activeIndex > 0) {\n        setSwipeDirection(-1);\n        setActiveIndex((prev) => prev - 1);\n        setShowOriginal(false);\n      }\n    },\n    [activeIndex, thumbnails.length]\n  );\n\n  const isMobile =\n    typeof window !== \"undefined\" && window.innerWidth < 768;\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"dv-detail-overlay\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.3 }}\n          onClick={onClose}\n        >\n          <motion.div\n            ref={panelRef}\n            className=\"dv-detail-panel\"\n            initial={{ y: isMobile ? 0 : 40, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            exit={{ y: isMobile ? 0 : 40, opacity: 0 }}\n            transition={{ duration: isMobile ? 0.2 : 0.35, ease: \"easeOut\" }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            {/* Close button */}\n            <button\n              className=\"dv-detail-panel__close\"\n              onClick={onClose}\n              aria-label=\"Close\"\n            >\n              <X size={24} />\n            </button>\n\n            {/* Scheduler button  mobile: centered compact pill */}\n            {config.schedulerUrl && isMobile && (\n              <div className=\"dv-detail__scheduler-row\">\n                <motion.button\n                  className=\"dv-detail__scheduler-btn dv-detail__scheduler-btn--mobile\"\n                  onClick={handleSchedulerClick}\n                  initial={{ y: -20, opacity: 0 }}\n                  animate={{ y: 0, opacity: 1 }}\n                  transition={{ delay: 0.3, duration: 0.3, ease: \"easeOut\" }}\n                >\n                  Make This Plan Yours\n                  <ArrowRight size={18} />\n                </motion.button>\n              </div>\n            )}\n\n            {/* Scheduler button  desktop: fixed right-center pill */}\n            {config.schedulerUrl && !isMobile && (\n              <motion.button\n                className=\"dv-detail__scheduler-btn dv-detail__scheduler-btn--desktop\"\n                onClick={handleSchedulerClick}\n                initial={{ x: 40, opacity: 0 }}\n                animate={{ x: 0, opacity: 1 }}\n                transition={{ delay: 0.5, duration: 0.35, ease: \"easeOut\" }}\n              >\n                Make This Plan Yours\n                <ArrowRight size={18} />\n              </motion.button>\n            )}\n\n            {/* Hero image  swipeable */}\n            <div className=\"dv-detail-hero\">\n              <AnimatePresence initial={false} mode=\"popLayout\" custom={swipeDirection}>\n                <motion.div\n                  key={activeIndex}\n                  className=\"dv-detail-hero__swipe-container\"\n                  drag={thumbnails.length > 1 ? \"x\" : false}\n                  dragConstraints={{ left: 0, right: 0 }}\n                  dragElastic={0.2}\n                  onDragEnd={handleHeroSwipe}\n                  onTap={() => setLightboxOpen(true)}\n                  custom={swipeDirection}\n                  initial=\"enter\"\n                  animate=\"center\"\n                  exit=\"exit\"\n                  variants={heroSlideVariants}\n                  transition={{ duration: 0.3, ease: \"easeInOut\" }}\n                  style={{ touchAction: \"pan-y\" }}\n                >\n                  <img\n                    src={displayUrl}\n                    alt={plan.title}\n                    className=\"dv-detail-hero__img\"\n                    draggable={false}\n                  />\n                </motion.div>\n              </AnimatePresence>\n\n              {isProcessing && (\n                <div className=\"dv-detail-hero__processing\">\n                  <div className=\"dv-detail-hero__shimmer\" />\n                  <span className=\"dv-detail-hero__processing-text\">\n                    AI is generating...\n                  </span>\n                </div>\n              )}\n\n              <div className=\"dv-detail-hero__gradient\" />\n\n              <div className=\"dv-detail-hero__info\">\n                <div className=\"dv-detail-hero__specs\">\n                  <span>\n                    <Home size={16} /> {plan.beds} Beds\n                  </span>\n                  <span>\n                    <Bath size={16} /> {plan.baths} Baths\n                  </span>\n                  <span>\n                    <Square size={16} /> {plan.area.toLocaleString()} sqft\n                  </span>\n                </div>\n              </div>\n\n              {/* Before/After toggle */}\n              {hasAiResult && (\n                <div className=\"dv-detail-hero__compare\">\n                  <button\n                    className={`dv-detail-hero__compare-btn ${\n                      !showOriginal\n                        ? \"dv-detail-hero__compare-btn--active\"\n                        : \"\"\n                    }`}\n                    onClick={() => setShowOriginal(false)}\n                  >\n                    AI Generated\n                  </button>\n                  <button\n                    className={`dv-detail-hero__compare-btn ${\n                      showOriginal\n                        ? \"dv-detail-hero__compare-btn--active\"\n                        : \"\"\n                    }`}\n                    onClick={() => setShowOriginal(true)}\n                  >\n                    Original\n                  </button>\n                </div>\n              )}\n\n              {/* Dot indicators */}\n              {thumbnails.length > 1 && (\n                <div className=\"dv-detail-hero__dots\">\n                  {thumbnails.map((_, i) => (\n                    <button\n                      key={i}\n                      className={`dv-detail-hero__dot ${\n                        i === activeIndex ? \"dv-detail-hero__dot--active\" : \"\"\n                      }`}\n                      onClick={() => {\n                        setSwipeDirection(i > activeIndex ? 1 : -1);\n                        setActiveIndex(i);\n                        setShowOriginal(false);\n                      }}\n                      aria-label={`Image ${i + 1}`}\n                    />\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {/* Body: grid layout */}\n            <div className=\"dv-detail-body\">\n              {/* Thumbnails  left column on desktop, first on mobile */}\n              {thumbnails.length > 1 && (\n                <div className=\"dv-detail-body__thumbs\">\n                  <div className=\"dv-detail-thumbs\">\n                    {thumbnails.map((thumb, index) => (\n                      <button\n                        key={thumb.url}\n                        className={`dv-detail-thumbs__item ${\n                          activeIndex === index\n                            ? \"dv-detail-thumbs__item--active\"\n                            : \"\"\n                        }`}\n                        onClick={() => {\n                          setSwipeDirection(index > activeIndex ? 1 : -1);\n                          setActiveIndex(index);\n                          setShowOriginal(false);\n                        }}\n                      >\n                        <img src={thumb.url} alt={thumb.label} />\n                        <span className=\"dv-detail-thumbs__label\">\n                          {thumb.label}\n                        </span>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* AI Tools  right sidebar on desktop, after thumbs on mobile */}\n              <div className=\"dv-detail-body__sidebar\">\n                <AIToolsPanel\n                  plan={plan}\n                  config={config}\n                  heroUrl={displayUrl}\n                  originalHeroUrl={currentOriginalUrl}\n                  imageType={imageType}\n                  floorPlanUrl={showOriginalFloorPlan ? originalFloorPlanUrl : floorPlanUrl}\n                  originalFloorPlanUrl={originalFloorPlanUrl}\n                  hasFloorPlanResult={hasFloorPlanResult}\n                  showOriginalFloorPlan={showOriginalFloorPlan}\n                  onToggleFloorPlanOriginal={setShowOriginalFloorPlan}\n                  onResult={handleResult}\n                  onProcessingChange={setIsProcessing}\n                />\n              </div>\n\n              {/* Main content  left column */}\n              <div className=\"dv-detail-body__main\">\n                {plan.description && (\n                  <p className=\"dv-detail-description\">{plan.description}</p>\n                )}\n\n                {plan.features.length > 0 && (\n                  <div className=\"dv-detail-features\">\n                    <h3 className=\"dv-detail-features__title\">Features</h3>\n                    <div className=\"dv-detail-features__grid\">\n                      {plan.features.map((feature) => (\n                        <div\n                          key={feature}\n                          className=\"dv-detail-features__item\"\n                        >\n                          <Check size={16} />\n                          <span>{feature}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Similar Plans  bottom of left column on desktop, very bottom on mobile */}\n              {config.enableSimilarPlans !== false &&\n                allPlans &&\n                allPlans.length > 1 && (\n                  <div className=\"dv-detail-body__similar\">\n                    <SimilarPlans\n                      currentPlan={plan}\n                      allPlans={allPlans}\n                      onPlanSelect={handlePlanSelect}\n                    />\n                  </div>\n                )}\n            </div>\n\n            <ImageLightbox\n              src={displayUrl}\n              alt={plan.title}\n              isOpen={lightboxOpen}\n              onClose={() => setLightboxOpen(false)}\n              images={thumbnails}\n              activeIndex={activeIndex}\n              onIndexChange={(i) => {\n                setSwipeDirection(i > activeIndex ? 1 : -1);\n                setActiveIndex(i);\n                setShowOriginal(false);\n              }}\n            />\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Sparkles } from \"lucide-react\";\nimport { DesignVaultProvider, useDesignVaultContext } from \"../hooks/useDesignVault\";\nimport { usePlans } from \"../hooks/usePlans\";\nimport { ArchiveGrid } from \"./ArchiveGrid\";\nimport { PlanDetail } from \"./PlanDetail\";\nimport { trackPageView } from \"../utils/tracking\";\nimport type { DesignVaultConfig, DesignVaultProps, FloorPlan } from \"../types\";\n\n//  Brand color helpers \n\nfunction hexToRgb(hex: string): [number, number, number] | null {\n  const m = hex\n    .replace(\"#\", \"\")\n    .match(/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);\n  if (!m) return null;\n  return [parseInt(m[1], 16), parseInt(m[2], 16), parseInt(m[3], 16)];\n}\n\nfunction lighten(hex: string, amount: number): string {\n  const rgb = hexToRgb(hex);\n  if (!rgb) return hex;\n  const out = rgb.map((c) =>\n    Math.min(255, Math.round(c + (255 - c) * amount))\n  );\n  return `#${out.map((c) => c.toString(16).padStart(2, \"0\")).join(\"\")}`;\n}\n\nfunction brandVars(\n  color: string,\n  colorLight?: string\n): React.CSSProperties {\n  const rgb = hexToRgb(color);\n  return {\n    \"--dv-brand\": color,\n    \"--dv-brand-light\": colorLight ?? lighten(color, 0.25),\n    \"--dv-brand-dim\": rgb\n      ? `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]}, 0.15)`\n      : \"rgba(184, 134, 11, 0.15)\",\n  } as React.CSSProperties;\n}\n\n//  Inner component (lives inside provider for hook access) \n\nfunction DesignVaultInner({ config }: { config: DesignVaultConfig }) {\n  const { anonymousId } = useDesignVaultContext();\n  const { plans } = usePlans();\n\n  const [selectedPlan, setSelectedPlan] = useState<FloorPlan | null>(null);\n\n  // Keep a ref to the last selected plan so AnimatePresence can exit-animate\n  const lastPlanRef = useRef<FloorPlan | null>(null);\n  if (selectedPlan) {\n    lastPlanRef.current = selectedPlan;\n  }\n\n  // Track page view on mount\n  useEffect(() => {\n    if (config.trackingEndpoint) {\n      trackPageView(config.builderSlug, anonymousId, config.trackingEndpoint);\n    }\n  }, [config.trackingEndpoint, config.builderSlug, anonymousId]);\n\n  // URL param deep linking: ?plan=<title> or ?plan=<id>\n  useEffect(() => {\n    if (plans.length === 0 || selectedPlan) return;\n    if (typeof window === \"undefined\") return;\n\n    const params = new URLSearchParams(window.location.search);\n    const planParam = params.get(\"plan\");\n    if (!planParam) return;\n\n    const decoded = decodeURIComponent(planParam);\n    const match = plans.find(\n      (p) =>\n        p.title.toLowerCase() === decoded.toLowerCase() || p.id === decoded\n    );\n    if (match) setSelectedPlan(match);\n  }, [plans, selectedPlan]);\n\n  const handlePlanSelect = useCallback((plan: FloorPlan) => {\n    setSelectedPlan(plan);\n  }, []);\n\n  const handleDetailClose = useCallback(() => {\n    setSelectedPlan(null);\n  }, []);\n\n  const handlePlanSwitch = useCallback((plan: FloorPlan) => {\n    setSelectedPlan(plan);\n  }, []);\n\n  // Use lastPlanRef so PlanDetail stays mounted during exit animation\n  const detailPlan = selectedPlan ?? lastPlanRef.current;\n\n  return (\n    <>\n      {/* Hero */}\n      <header className=\"dv-hero\">\n        <div className=\"dv-hero__badge\">\n          <Sparkles size={13} />\n          AI-Powered Design\n        </div>\n        <h1 className=\"dv-hero__title\">Design Your Dream Home</h1>\n        <p className=\"dv-hero__subtitle\">Browse. Customize. Build.</p>\n        <p className=\"dv-hero__desc\">\n          Explore {plans.length > 0 ? `${plans.length}+` : \"\"} custom floor\n          plans and use AI to make them yours\n        </p>\n      </header>\n\n      {/* Archive grid */}\n      <main className=\"dv-container\">\n        <ArchiveGrid onPlanSelect={handlePlanSelect} />\n      </main>\n\n      {/* Plan detail overlay */}\n      {detailPlan && (\n        <PlanDetail\n          plan={detailPlan}\n          isOpen={!!selectedPlan}\n          onClose={handleDetailClose}\n          config={config}\n          allPlans={plans}\n          onPlanSwitch={handlePlanSwitch}\n        />\n      )}\n\n      {/* Attribution footer */}\n      {config.attribution?.show && (\n        <footer className=\"dv-attribution\">\n          <span>Designed by </span>\n          <a\n            href={config.attribution.url}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            {config.attribution.text}\n          </a>\n        </footer>\n      )}\n    </>\n  );\n}\n\n//  Main export \n\nexport const DesignVault: React.FC<DesignVaultProps> = ({\n  config,\n  className,\n}) => {\n  return (\n    <DesignVaultProvider config={config}>\n      <div\n        className={`dv-root ${className ?? \"\"}`}\n        style={brandVars(config.brandColor, config.brandColorLight)}\n      >\n        <DesignVaultInner config={config} />\n      </div>\n    </DesignVaultProvider>\n  );\n};\n"]}